(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-1f6cf001"],{"0a26":function(e,t,i){"use strict";i.d(t,"a",function(){return o});var a=i("ad06"),n=i("78eb"),s=i("9884"),r=i("ea8e"),o=function(e){var t=e.parent,i=e.bem,o=e.role;return{mixins:[Object(s["a"])(t),n["a"]],props:{name:null,value:null,disabled:Boolean,iconSize:[Number,String],checkedColor:String,labelPosition:String,labelDisabled:Boolean,shape:{type:String,default:"round"},bindGroup:{type:Boolean,default:!0}},computed:{disableBindRelation:function(){return!this.bindGroup},isDisabled:function(){return this.parent&&this.parent.disabled||this.disabled},direction:function(){return this.parent&&this.parent.direction||null},iconStyle:function(){var e=this.checkedColor||this.parent&&this.parent.checkedColor;if(e&&this.checked&&!this.isDisabled)return{borderColor:e,backgroundColor:e}},tabindex:function(){return this.isDisabled||"radio"===o&&!this.checked?-1:0}},methods:{onClick:function(e){var t=e.target,i=this.$refs.icon,a=i===t||i.contains(t);this.isDisabled||!a&&this.labelDisabled||this.toggle(),this.$emit("click",e)},genIcon:function(){var e=this.$createElement,t=this.checked,n=this.iconSize||this.parent&&this.parent.iconSize;return e("div",{ref:"icon",class:i("icon",[this.shape,{disabled:this.isDisabled,checked:t}]),style:{fontSize:Object(r["a"])(n)}},[this.slots("icon",{checked:t})||e(a["a"],{attrs:{name:"success"},style:this.iconStyle})])},genLabel:function(){var e=this.$createElement,t=this.slots();if(t)return e("span",{class:i("label",[this.labelPosition,{disabled:this.isDisabled}])},[t])}},render:function(){var e=arguments[0],t=[this.genIcon()];return"left"===this.labelPosition?t.unshift(this.genLabel()):t.push(this.genLabel()),e("div",{attrs:{role:o,tabindex:this.tabindex,"aria-checked":String(this.checked)},class:i([{disabled:this.isDisabled,"label-disabled":this.labelDisabled},this.direction]),on:{click:this.onClick}},[t])}}}},"162c":function(e,t,i){},"21ab":function(e,t,i){"use strict";var a=i("c31d"),n=i("d282"),s=i("ea8e"),r=i("b1d2"),o=i("48f4"),c=i("9884"),l=i("6f2f"),u=i("ad06"),h=Object(n["a"])("grid-item"),d=h[0],g=h[1];t["a"]=d({mixins:[Object(c["a"])("vanGrid")],props:Object(a["a"])({},o["c"],{dot:Boolean,text:String,icon:String,info:[Number,String]}),computed:{style:function(){var e=this.parent,t=e.square,i=e.gutter,a=e.columnNum,n=100/a+"%",r={flexBasis:n};if(t)r.paddingTop=n;else if(i){var o=Object(s["a"])(i);r.paddingRight=o,this.index>=a&&(r.marginTop=o)}return r},contentStyle:function(){var e=this.parent,t=e.square,i=e.gutter;if(t&&i){var a=Object(s["a"])(i);return{right:a,bottom:a,height:"auto"}}}},methods:{onClick:function(e){this.$emit("click",e),Object(o["b"])(this.$router,this)},genIcon:function(){var e=this.$createElement,t=this.slots("icon");return t?e("div",{class:g("icon-wrapper")},[t,e(l["a"],{attrs:{dot:this.dot,info:this.info}})]):this.icon?e(u["a"],{attrs:{name:this.icon,dot:this.dot,info:this.info,size:this.parent.iconSize},class:g("icon")}):void 0},getText:function(){var e=this.$createElement,t=this.slots("text");return t||(this.text?e("span",{class:g("text")},[this.text]):void 0)},genContent:function(){var e=this.slots();return e||[this.genIcon(),this.getText()]}},render:function(){var e,t=arguments[0],i=this.parent,a=i.center,n=i.border,s=i.square,o=i.gutter,c=i.clickable;return t("div",{class:[g({square:s})],style:this.style},[t("div",{style:this.contentStyle,attrs:{role:c?"button":null,tabindex:c?0:null},class:[g("content",{center:a,square:s,clickable:c,surround:n&&o}),(e={},e[r["b"]]=n,e)],on:{click:this.onClick}},[this.genContent()])])}})},2464:function(e,t,i){},2830:function(e,t,i){"use strict";var a=i("d282"),n=i("ea8e"),s=i("b1d2"),r=i("9884"),o=Object(a["a"])("grid"),c=o[0],l=o[1];t["a"]=c({mixins:[Object(r["b"])("vanGrid")],props:{square:Boolean,gutter:[Number,String],iconSize:[Number,String],clickable:Boolean,columnNum:{type:[Number,String],default:4},center:{type:Boolean,default:!0},border:{type:Boolean,default:!0}},computed:{style:function(){var e=this.gutter;if(e)return{paddingLeft:Object(n["a"])(e)}}},render:function(){var e,t=arguments[0];return t("div",{style:this.style,class:[l(),(e={},e[s["f"]]=this.border&&!this.gutter,e)]},[this.slots()])}})},"2bdd":function(e,t,i){"use strict";var a=i("d282"),n=i("02de"),s=i("a8c1"),r=i("5fbe"),o=i("543e"),c=Object(a["a"])("list"),l=c[0],u=c[1],h=c[2];t["a"]=l({mixins:[Object(r["a"])(function(e){this.scroller||(this.scroller=Object(s["d"])(this.$el)),e(this.scroller,"scroll",this.check)})],model:{prop:"loading"},props:{error:Boolean,loading:Boolean,finished:Boolean,errorText:String,loadingText:String,finishedText:String,immediateCheck:{type:Boolean,default:!0},offset:{type:[Number,String],default:300},direction:{type:String,default:"down"}},data:function(){return{innerLoading:this.loading}},updated:function(){this.innerLoading=this.loading},mounted:function(){this.immediateCheck&&this.check()},watch:{loading:"check",finished:"check"},methods:{check:function(){var e=this;this.$nextTick(function(){if(!(e.innerLoading||e.finished||e.error)){var t,i=e.$el,a=e.scroller,s=e.offset,r=e.direction;t=a.getBoundingClientRect?a.getBoundingClientRect():{top:0,bottom:a.innerHeight};var o=t.bottom-t.top;if(!o||Object(n["a"])(i))return!1;var c=!1,l=e.$refs.placeholder.getBoundingClientRect();c="up"===r?t.top-l.top<=s:l.bottom-t.bottom<=s,c&&(e.innerLoading=!0,e.$emit("input",!0),e.$emit("load"))}})},clickErrorText:function(){this.$emit("update:error",!1),this.check()},genLoading:function(){var e=this.$createElement;if(this.innerLoading&&!this.finished)return e("div",{class:u("loading"),key:"loading"},[this.slots("loading")||e(o["a"],{attrs:{size:"16"}},[this.loadingText||h("loading")])])},genFinishedText:function(){var e=this.$createElement;if(this.finished){var t=this.slots("finished")||this.finishedText;if(t)return e("div",{class:u("finished-text")},[t])}},genErrorText:function(){var e=this.$createElement;if(this.error){var t=this.slots("error")||this.errorText;if(t)return e("div",{on:{click:this.clickErrorText},class:u("error-text")},[t])}}},render:function(){var e=arguments[0],t=e("div",{ref:"placeholder",class:u("placeholder")});return e("div",{class:u(),attrs:{role:"feed","aria-busy":this.innerLoading}},["down"===this.direction?this.slots():t,this.genLoading(),this.genFinishedText(),this.genErrorText(),"up"===this.direction?this.slots():t])}})},"37ff":function(e,t,i){},"3acc":function(e,t,i){"use strict";var a=i("d282"),n=i("78eb"),s=i("9884"),r=Object(a["a"])("checkbox-group"),o=r[0],c=r[1];t["a"]=o({mixins:[Object(s["b"])("vanCheckbox"),n["a"]],props:{max:[Number,String],disabled:Boolean,direction:String,iconSize:[Number,String],checkedColor:String,value:{type:Array,default:function(){return[]}}},watch:{value:function(e){this.$emit("change",e)}},methods:{toggleAll:function(e){if(!1!==e){var t=this.children;e||(t=t.filter(function(e){return!e.checked}));var i=t.map(function(e){return e.name});this.$emit("input",i)}else this.$emit("input",[])}},render:function(){var e=arguments[0];return e("div",{class:c([this.direction])},[this.slots()])}})},4072:function(e,t,i){"use strict";i("3cd0"),i("162c")},"417e":function(e,t,i){"use strict";var a=i("d282"),n=i("0a26"),s=Object(a["a"])("checkbox"),r=s[0],o=s[1];t["a"]=r({mixins:[Object(n["a"])({bem:o,role:"checkbox",parent:"vanCheckbox"})],computed:{checked:{get:function(){return this.parent?-1!==this.parent.value.indexOf(this.name):this.value},set:function(e){this.parent?this.setParentValue(e):this.$emit("input",e)}}},watch:{value:function(e){this.$emit("change",e)}},methods:{toggle:function(e){var t=this;void 0===e&&(e=!this.checked),clearTimeout(this.toggleTask),this.toggleTask=setTimeout(function(){t.checked=e})},setParentValue:function(e){var t=this.parent,i=t.value.slice();if(e){if(t.max&&i.length>=t.max)return;-1===i.indexOf(this.name)&&(i.push(this.name),t.$emit("input",i))}else{var a=i.indexOf(this.name);-1!==a&&(i.splice(a,1),t.$emit("input",i))}}}})},"53f3":function(e,t,i){},"578d":function(e,t,i){"use strict";i("3cd0"),i("25bb"),i("f8c2")},6370:function(e,t,i){"use strict";i("3cd0"),i("64d7")},"64d7":function(e,t,i){},6762:function(e,t,i){"use strict";var a=i("5ca1"),n=i("c366")(!0);a(a.P,"Array",{includes:function(e){return n(this,e,arguments.length>1?arguments[1]:void 0)}}),i("9c6c")("includes")},"7bd9":function(e,t,i){"use strict";var a=i("d282"),n=i("1325"),s=i("b1d2"),r=i("5fbe"),o=i("3875"),c=Object(a["a"])("key"),l=c[0],u=c[1],h=l({mixins:[o["a"]],props:{type:String,text:[Number,String],theme:{type:Array,default:function(){return[]}}},data:function(){return{active:!1}},computed:{className:function(){var e=this.theme.slice(0);return this.active&&e.push("active"),this.type&&e.push(this.type),u(e)}},mounted:function(){this.bindTouchEvent(this.$el)},methods:{onTouchStart:function(e){e.stopPropagation(),this.touchStart(e),this.active=!0},onTouchMove:function(e){this.touchMove(e),this.direction&&(this.active=!1)},onTouchEnd:function(){this.active&&(this.active=!1,this.$emit("press",this.text,this.type))}},render:function(){var e=arguments[0];return e("i",{attrs:{role:"button",tabindex:"0"},class:[s["b"],this.className]},[this.slots("default")||this.text])}}),d=Object(a["a"])("number-keyboard"),g=d[0],m=d[1],f=d[2],p=["blue","big"],b=["delete","big","gray"];t["a"]=g({mixins:[Object(r["a"])(function(e){this.hideOnClickOutside&&e(document.body,"touchstart",this.onBlur)})],model:{event:"update:value"},props:{show:Boolean,title:String,zIndex:[Number,String],closeButtonText:String,deleteButtonText:String,theme:{type:String,default:"default"},value:{type:String,default:""},extraKey:{type:String,default:""},maxlength:{type:[Number,String],default:Number.MAX_VALUE},transition:{type:Boolean,default:!0},showDeleteKey:{type:Boolean,default:!0},hideOnClickOutside:{type:Boolean,default:!0},safeAreaInsetBottom:{type:Boolean,default:!0}},watch:{show:function(e){this.transition||this.$emit(e?"show":"hide")}},computed:{keys:function(){for(var e=[],t=1;t<=9;t++)e.push({text:t});switch(this.theme){case"default":e.push({text:this.extraKey,theme:["gray"],type:"extra"},{text:0},{text:this.deleteText,theme:["gray"],type:"delete"});break;case"custom":e.push({text:0,theme:["middle"]},{text:this.extraKey,type:"extra"});break}return e},deleteText:function(){return this.deleteButtonText||f("delete")}},methods:{onBlur:function(){this.show&&this.$emit("blur")},onClose:function(){this.$emit("close"),this.onBlur()},onAnimationEnd:function(){this.$emit(this.show?"show":"hide")},onPress:function(e,t){if(""!==e){var i=this.value;"delete"===t?(this.$emit("delete"),this.$emit("update:value",i.slice(0,i.length-1))):"close"===t?this.onClose():i.length<this.maxlength&&(this.$emit("input",e),this.$emit("update:value",i+e))}},genTitle:function(){var e=this.$createElement,t=this.title,i=this.theme,a=this.closeButtonText,n=this.slots("title-left"),r=a&&"default"===i,o=t||r||n;if(o)return e("div",{class:[m("title"),s["f"]]},[n&&e("span",{class:m("title-left")},[n]),t&&e("span",[t]),r&&e("span",{attrs:{role:"button",tabindex:"0"},class:m("close"),on:{click:this.onClose}},[a])])},genKeys:function(){var e=this,t=this.$createElement;return this.keys.map(function(i){return t(h,{key:i.text,attrs:{text:i.text,type:i.type,theme:i.theme},on:{press:e.onPress}},["delete"===i.type&&e.slots("delete"),"extra"===i.type&&e.slots("extra-key")])})},genSidebar:function(){var e=this.$createElement;if("custom"===this.theme)return e("div",{class:m("sidebar")},[e(h,{attrs:{text:this.deleteText,type:"delete",theme:b},on:{press:this.onPress}},[this.slots("delete")]),e(h,{attrs:{text:this.closeButtonText,type:"close",theme:p},on:{press:this.onPress}})])}},render:function(){var e=arguments[0];return e("transition",{attrs:{name:this.transition?"van-slide-up":""}},[e("div",{directives:[{name:"show",value:this.show}],style:{zIndex:this.zIndex},class:m([this.theme,{"safe-area-inset-bottom":this.safeAreaInsetBottom}]),on:{touchstart:n["d"],animationend:this.onAnimationEnd,webkitAnimationEnd:this.onAnimationEnd}},[this.genTitle(),e("div",{class:m("body")},[this.genKeys(),this.genSidebar()])])])}})},"81a6":function(e,t,i){"use strict";i("3cd0"),i("f6a1")},"93b0":function(e,t,i){"use strict";i("3cd0"),i("25bb"),i("37ff")},"96b0":function(e,t,i){"use strict";i.d(t,"c",function(){return n}),i.d(t,"b",function(){return s}),i.d(t,"a",function(){return r});var a=i("90c6");function n(e,t){var i=-1,a=Array(e);while(++i<e)a[i]=t(i);return a}function s(e){if(!e)return 0;while(Object(a["a"])(parseInt(e,10))){if(!(e.length>1))return 0;e=e.slice(1)}return parseInt(e,10)}function r(e,t){return 32-new Date(e,t-1,32).getDate()}},9753:function(e,t,i){"use strict";i("3cd0"),i("1a44"),i("acc2"),i("2464")},a035:function(e,t,i){"use strict";i("3cd0"),i("1a44"),i("acc2"),i("ff04")},bad1:function(e,t,i){"use strict";i.d(t,"a",function(){return n});var a=i("90c6");function n(e){return"[object Date]"===Object.prototype.toString.call(e)&&!Object(a["a"])(e.getTime())}},be8b:function(e,t,i){"use strict";var a=i("53f3"),n=i.n(a);n.a},edad:function(e,t,i){"use strict";i.r(t);var a,n=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",[i("div",{staticClass:"omsp-eventregist",attrs:{id:"omspeventregist"}},[i("van-nav-bar",{staticClass:"omsp-nav-bar",attrs:{title:"发布登记","left-text":"返回","left-arrow":"",fixed:""},on:{"click-left":e.backToIndex}}),i("div",{staticClass:"omsp-eventregist-body"},[i("van-tabs",{attrs:{"lazy-render":!1},model:{value:e.tabNum,callback:function(t){e.tabNum=t},expression:"tabNum"}},[i("van-tab",{attrs:{title:"基本信息"}},[i("van-cell-group",[i("van-field",{attrs:{"input-align":"right",required:"",clearable:"",label:"发布标题",placeholder:"请输入",clickable:""},model:{value:e.title,callback:function(t){e.title=t},expression:"title"}}),i("van-field",{attrs:{"input-align":"right",required:"",clearable:"",label:"发布人",placeholder:"请输入",clickable:"",readonly:""},model:{value:e.username,callback:function(t){e.username=t},expression:"username"}}),i("van-field",{attrs:{"input-align":"right",required:"",clearable:"",label:"发布时间",placeholder:"点击选择时间",clickable:"",readonly:""},on:{click:function(t){e.showReleaseDatePickerFlag=!0}},model:{value:e.release_date,callback:function(t){e.release_date=t},expression:"release_date"}}),i("van-field",{attrs:{"input-align":"right",required:"",clearable:"",label:"所属部门",placeholder:"点击选择所属部门","default-index":"0",clickable:"","right-icon":"arrow",readonly:""},on:{click:function(t){e.showOriginSelectorFlag=!0}},model:{value:e.origin.name,callback:function(t){e.$set(e.origin,"name",t)},expression:"origin.name"}}),i("van-field",{attrs:{"input-align":"right",required:"",clearable:"",label:"所属团队",placeholder:"点击选择所属团队",clickable:"","right-icon":"arrow",readonly:""},on:{click:function(t){e.showTeamSelectorFlag=!0}},model:{value:e.team.name,callback:function(t){e.$set(e.team,"name",t)},expression:"team.name"}}),i("van-field",{attrs:{"input-align":"right",required:"",clearable:"",label:"所属系统",placeholder:"点击选择所属系统",clickable:"","right-icon":"arrow",readonly:""},on:{click:function(t){e.showTargetSysSelectorFlag=!0}},model:{value:e.targetSys.name,callback:function(t){e.$set(e.targetSys,"name",t)},expression:"targetSys.name"}}),i("van-field",{attrs:{"input-align":"right",required:"",clearable:"",label:"优先级",placeholder:"点击选择优先级",clickable:"","right-icon":"arrow",readonly:""},on:{click:function(t){e.showUrgencySelectorFlag=!0}},model:{value:e.urgency.name,callback:function(t){e.$set(e.urgency,"name",t)},expression:"urgency.name"}}),i("van-field",{attrs:{"input-align":"right",clearable:"",label:"发布包名称",placeholder:"请输入",clickable:""},model:{value:e.package_name,callback:function(t){e.package_name=t},expression:"package_name"}}),i("van-field",{attrs:{"input-align":"right",clearable:"",label:"发布包版本",placeholder:"请输入",clickable:""},model:{value:e.package_version,callback:function(t){e.package_version=t},expression:"package_version"}})],1),i("van-cell-group",[i("van-panel",{attrs:{title:"目标SERVER",icon:"comment"}},[i("p",{staticStyle:{color:"green","margin-left":"9%","font-size":"12px"}},[e._v("\n                注：目标server录入格式ip:端口，多个server用;分隔。如：192.168.10.1:8081;192.168.10.1:8082")]),i("van-field",{attrs:{"label-width":"0px",type:"textarea",placeholder:"请输入目标SERVER",rows:"2",autosize:e.targetServerTextarea,clearable:""},model:{value:e.target_server,callback:function(t){e.target_server=t},expression:"target_server"}}),i("div",{attrs:{id:"toolbar-container"}})],1)],1),i("van-cell-group",[i("van-panel",{attrs:{title:"发布描述",icon:"comment"}},[i("van-field",{attrs:{"label-width":"0px",type:"textarea",placeholder:"请输入发布描述",rows:"2",autosize:e.targetServerTextarea,clearable:""},model:{value:e.description,callback:function(t){e.description=t},expression:"description"}}),i("div",{attrs:{id:"toolbar-container2"}})],1)],1),i("van-cell-group",[i("van-panel",{attrs:{title:"发布内容",icon:"notes-o"}},[i("van-checkbox-group",{model:{value:e.checkBoxResult,callback:function(t){e.checkBoxResult=t},expression:"checkBoxResult"}},[i("van-list",{attrs:{finished:e.loadFinish,"finished-text":"没有更多了"},model:{value:e.loading,callback:function(t){e.loading=t},expression:"loading"}},e._l(e.list,function(t){return i("van-panel",{key:t.change_id,staticClass:"omsp-panel",on:{click:function(i){return e.toggle(t.change_id)}}},[i("div",{attrs:{slot:"header"},slot:"header"}),i("div",{attrs:{slot:"default"},slot:"default"},[i("van-row",{staticStyle:{height:"85px"}},[i("van-col",{attrs:{span:"6"}},[i("van-checkbox",{key:t.change_id,ref:"checkboxes",refInFor:!0,staticStyle:{margin:"30%"},attrs:{name:t.change_id}})],1),i("van-col",{attrs:{span:"12"}},[i("p",{staticClass:"ellipsis2",staticStyle:{"font-size":"12px",color:"#969799"}},[e._v(e._s(t.change_id))]),i("p",{staticClass:"ellipsis2",staticStyle:{"font-size":"20px"}},[e._v(e._s(t.title))]),"01"===t.change_type?i("van-tag",{attrs:{type:"primary"}},[e._v("标准变更")]):e._e(),"02"===t.change_type?i("van-tag",{attrs:{type:"warning"}},[e._v("紧急变更")]):e._e(),"03"===t.change_type?i("van-tag",{attrs:{type:"danger"}},[e._v("重大变更")]):e._e(),"03"===t.source?i("van-tag",{attrs:{mark:"",type:"success"}},[e._v("来源:变更创建")]):e._e(),"02"===t.source?i("van-tag",{attrs:{mark:"",type:"success"}},[e._v("来源:问题管理")]):e._e(),"01"===t.source?i("van-tag",{attrs:{mark:"",type:"success"}},[e._v("来源:事件管理")]):e._e()],1),i("van-col",{attrs:{span:"6"}},[i("p",{staticClass:"ellipsis2",staticStyle:{"font-size":"12px",color:"#969799","margin-top":"20px"}},[e._v("申请人：")]),i("p",{staticClass:"ellipsis2",staticStyle:{"font-size":"12px",color:"#969799"}},[e._v(e._s(t.applicant))])])],1)],1)])}),1)],1)],1)],1)],1),i("van-tab",{attrs:{title:"附件管理"}},[i("task-file",{attrs:{bsid:e.bsid||e.$route.params.bsid,biz_code:e.biz_code}})],1)],1)],1),i("div",{staticClass:"omsp-eventregist-foot"},[i("div",{staticClass:"omsp-eventregist-foot-grid"},[i("div",{staticClass:"omsp-eventregist-foot-grid-item",staticStyle:{"background-color":"#1A88E9"}},[i("div",{staticClass:"omsp-eventregist-foot-grid-item-center",on:{click:function(t){return e.save("commit")}}},[i("span",{staticClass:"omsp-eventregist-foot-grid-item-center-text"},[e._v("提交")])])]),i("div",{staticClass:"omsp-eventregist-foot-grid-item",staticStyle:{"background-color":"#BBBCC2"}},[i("div",{staticClass:"omsp-eventregist-foot-grid-item-center",on:{click:function(t){return e.save("draft")}}},[i("span",{staticClass:"omsp-eventregist-foot-grid-item-center-text"},[e._v("存为草稿")])])])])]),i("van-popup",{attrs:{position:"bottom"},model:{value:e.showReleaseDatePickerFlag,callback:function(t){e.showReleaseDatePickerFlag=t},expression:"showReleaseDatePickerFlag"}},[i("van-datetime-picker",{attrs:{type:"datetime",title:"发布时间","min-date":e.minReleaseDate,"max-date":e.maxReleaseDate},on:{confirm:e.confirmReleaseDate,cancel:function(t){e.showReleaseDatePickerFlag=!1}},model:{value:e.pickingReleaseDate,callback:function(t){e.pickingReleaseDate=t},expression:"pickingReleaseDate"}})],1),i("van-popup",{attrs:{position:"bottom"},model:{value:e.showUrgencySelectorFlag,callback:function(t){e.showUrgencySelectorFlag=t},expression:"showUrgencySelectorFlag"}},[i("van-picker",{attrs:{loading:e.urgencyLoading,columns:e.urgencySelector,"show-toolbar":"",title:"优先级"},on:{cancel:function(t){e.showUrgencySelectorFlag=!1},confirm:e.confirmUrgency}})],1),i("van-popup",{attrs:{position:"bottom"},model:{value:e.showOriginSelectorFlag,callback:function(t){e.showOriginSelectorFlag=t},expression:"showOriginSelectorFlag"}},[i("van-picker",{attrs:{loading:e.originLoading,columns:e.originSelector,"show-toolbar":"",title:"所属部门"},on:{cancel:function(t){e.showOriginSelectorFlag=!1},confirm:e.confirmOrigin}})],1),i("van-popup",{attrs:{position:"bottom"},model:{value:e.showTeamSelectorFlag,callback:function(t){e.showTeamSelectorFlag=t},expression:"showTeamSelectorFlag"}},[i("van-picker",{attrs:{loading:e.teamLoading,columns:e.teamSelector,"show-toolbar":"",title:"所属团队"},on:{cancel:function(t){e.showTeamSelectorFlag=!1},confirm:e.confirmTeam}})],1),i("van-popup",{attrs:{position:"bottom"},model:{value:e.showTargetSysSelectorFlag,callback:function(t){e.showTargetSysSelectorFlag=t},expression:"showTargetSysSelectorFlag"}},[i("van-picker",{attrs:{loading:e.targetSysLoading,columns:e.targetSysSelector,"show-toolbar":"",title:"所属系统"},on:{cancel:function(t){e.showTargetSysSelectorFlag=!1},confirm:e.confirmTargetSys}})],1)],1)])},s=[],r=(i("47e2"),i("2241")),o=(i("6762"),i("bd86")),c=(i("558f"),i("0b33")),l=(i("8990"),i("5e46")),u=(i("d707"),i("8f80")),h=(i("a035"),i("21ab")),d=(i("4072"),i("2830")),g=(i("2a53"),i("34e9")),m=(i("6370"),i("3acc")),f=(i("9753"),i("417e")),p=(i("3ec1"),i("7744")),b=(i("8e11"),i("f253")),v=(i("81a6"),i("7bd9")),y=(i("c625"),i("b650")),k=(i("87d0"),i("e41f")),x=(i("47d1"),i("9ffb")),S=(i("4bc8"),i("d1e1")),O=(i("4071"),i("a3e2")),_=(i("578d"),i("ee83")),j=(i("93b0"),i("2bdd")),w=(i("aa1f"),i("ea47")),D=(i("9eda"),i("565f")),T=(i("433b"),i("d399")),$=(i("da02"),i("6b41")),L=i("0ed4"),R={name:"OmspAddProblem",components:(a={},Object(o["a"])(a,$["a"].name,$["a"]),Object(o["a"])(a,T["a"].name,T["a"]),Object(o["a"])(a,D["a"].name,D["a"]),Object(o["a"])(a,w["a"].name,w["a"]),Object(o["a"])(a,j["a"].name,j["a"]),Object(o["a"])(a,_["a"].name,_["a"]),Object(o["a"])(a,O["a"].name,O["a"]),Object(o["a"])(a,S["a"].name,S["a"]),Object(o["a"])(a,x["a"].name,x["a"]),Object(o["a"])(a,k["a"].name,k["a"]),Object(o["a"])(a,y["a"].name,y["a"]),Object(o["a"])(a,v["a"].name,v["a"]),Object(o["a"])(a,b["a"].name,b["a"]),Object(o["a"])(a,p["a"].name,p["a"]),Object(o["a"])(a,f["a"].name,f["a"]),Object(o["a"])(a,m["a"].name,m["a"]),Object(o["a"])(a,g["a"].name,g["a"]),Object(o["a"])(a,d["a"].name,d["a"]),Object(o["a"])(a,h["a"].name,h["a"]),Object(o["a"])(a,u["a"].name,u["a"]),Object(o["a"])(a,l["a"].name,l["a"]),Object(o["a"])(a,c["a"].name,c["a"]),Object(o["a"])(a,"TaskFile",L["a"]),a),data:function(){return{releaseData:{},biz_code:"FB",tabNum:0,list:[],checkBoxResult:[],refreshing:!1,loading:!1,loadFinish:!0,bsid:"",incident_id:"",problem_id:"",title:"",userid:"",username:"",showReleaseDatePickerFlag:!1,minReleaseDate:new Date(2e3,0,1),maxReleaseDate:new Date,pickingReleaseDate:new Date,release_date:"",urgency:{},showUrgencySelectorFlag:!1,urgencyLoading:!0,urgencySelector:[],urgencyList:[],origin:"",showOriginSelectorFlag:!1,originLoading:!0,originSelector:[],originList:[],team:{},showTeamSelectorFlag:!1,teamLoading:!0,teamSelector:[],teamList:[],showTargetSysSelectorFlag:!1,targetSysSelector:[],targetSys:{},targetSysLoading:!0,targetSysList:[],package_name:"",package_version:"",target_server:"",targetServerTextarea:{maxHeight:150,minHeight:50},description:"",imgPreviewList:[],imgFileList:[]}},computed:{maxPlanFinishDate:function(){var e=new Date;return e.setMonth(e.getMonth()+6),e}},mounted:function(){this.getBasicInfo()},methods:{backToIndex:function(){this.$router.slid="right",this.$router.back()},refresh:function(){var e=this;this.list=[],this.loading=!1,this.loadFinish=!0,this.$OmspRequest.sendRequest({url:"/appReleaseRestService/queryReleaseContent",data:{target_sys:this.targetSys.id}}).then(function(t){e.list=JSON.parse(t.data.result),e.refreshing=!1,e.loading=!1,e.loadFinish=!0}).catch(function(e){JSON.stringify(e),Object(T["a"])("加载待办列表失败，请重新登录")}).finally(function(){e.refreshing=!1,e.loading=!1,e.loadFinish=!0})},toggle:function(e){for(var t=0;t<this.list.length;t++)e===this.list[t].change_id&&this.$refs.checkboxes[t].toggle()},confirmReleaseDate:function(e){var t=e.getMonth()+1;this.release_date=e.getFullYear()+"-"+(t>9?t:"0"+t)+"-"+(e.getDate()>9?e.getDate():"0"+e.getDate())+" "+(e.getHours()>9?e.getHours():"0"+e.getHours())+":"+(e.getMinutes()>9?e.getMinutes():"0"+e.getMinutes())+":00",this.showReleaseDatePickerFlag=!1},confirmUrgency:function(e,t){this.urgency=this.urgencyList[t],this.showUrgencySelectorFlag=!1},confirmOrigin:function(e,t){this.origin=this.originList[t],this.showOriginSelectorFlag=!1},confirmTeam:function(e,t){var i=this;this.team=this.teamList[t],this.showTeamSelectorFlag=!1,this.$OmspRequest.sendRequest({url:"/appTaskRestService/getTargetSys",data:{team_id:this.team.id}}).then(function(e){i.targetSysList=e.data.targetSysList,i.targetSysSelector=[];for(var t=0;t<i.targetSysList.length;t++)i.targetSysSelector.push(i.targetSysList[t].name);1===i.targetSysList.length&&(i.targetSys=i.targetSysList[0]),i.targetSysLoading=!1,setTimeout(function(){if(i.targetSysList)for(var e=0;e<i.targetSysList.length;e++)i.releaseData.target_sys===i.targetSysList[e].id&&(i.targetSys=i.targetSysList[e])},0)}).catch(function(e){JSON.stringify(e),Object(T["a"])("加载失败，请重新登录")}).finally(function(){})},confirmTargetSys:function(e,t){"number"===typeof t&&(this.targetSys=this.targetSysList[t]),this.showTargetSysSelectorFlag=!1,this.refresh()},beforeReadImg:function(e){var t=e.type,i=["image/png","image/jpeg"];return!!i.includes(t)||(T["a"].fail("请上传:png、jpeg的图片格式"),!1)},afterReadImg:function(e){return e},save:function(e){var t=this,i=this.checkForm();i.flag?r["a"].confirm({title:"通知",message:"确定这项操作吗?"}).then(function(){T["a"].loading({mask:!0,forbidClick:!0,duration:0,message:"请稍后..."});var i=t.getFormData();setTimeout(function(){t.$OmspRequest.sendRequest({url:"/appReleaseRestService/saveRelease",data:i}).then(function(i){T["a"].clear(),t.bsid=i.data.id,t.$nextTick(function(){t.$store.commit("page/removeCachePageName","OmspIndex"),"draft"===e?t.keepEdit():"commit"===e&&t.submit()})}).catch(function(e){JSON.stringify(e),console.log(e),T["a"].fail("暂存失败")}).finally(function(){})},0)}).catch(function(){}):T["a"].fail(i.msg)},keepEdit:function(){var e=this;r["a"].confirm({title:"暂存成功",message:"是否继续修改？"}).then(function(){}).catch(function(){setTimeout(function(){e.$router.push({path:"index"})})})},submit:function(){var e=this;T["a"].loading({mask:!0,forbidClick:!0,duration:0,message:"提交中，请稍后..."});var t=this.getFormData();this.checkBoxResult.length&&0!==this.checkBoxResult.length?setTimeout(function(){e.$OmspRequest.sendRequest({url:"/appReleaseRestService/submitRelease",data:{id:t.id}}).then(function(t){T["a"].clear(),JSON.stringify(t),r["a"].alert({message:"提交成功，即将返回主页"}).then(function(){e.$store.commit("page/removeCachePageName","OmspIndex"),setTimeout(function(){e.$router.push({path:"index"})})})}).catch(function(e){JSON.stringify(e),T["a"].fail("提交失败")}).finally(function(){})},0):T["a"].fail("请选择发布内容！")},getFormData:function(){var e=[];if(this.checkBoxResult.length)for(var t=0;t<this.checkBoxResult.length;t++)for(var i=0;i<this.list.length;i++)this.checkBoxResult[t]===this.list[i].change_id&&(e[t]={},e[t]=this.list[i]);var a={urgency_desc:this.urgency.name,is_view:"",description:this.description,pos_orgname:this.origin.orgname,team_id:this.team.id,title:this.title,orgid:this.origin.id,team_id_desc:this.team.name,is_base:"1",package_version:this.package_version,release_date:this.release_date,urgency:this.urgency.id,org_id:this.origin.id,is_draft:"1",release_user:this.username,package_name:this.package_name,target_sys:this.targetSys.id,menuid:"",release_obj_list:JSON.stringify(e),id:this.bsid,target_server:this.target_server,target_sys_desc:this.targetSys.name};return a},getBasicInfo:function(){var e=this;Object(T["a"])({type:"loading",overlay:!0,message:"加载中...",duration:0,forbidClick:!0}),setTimeout(function(){e.$OmspRequest.sendRequest({url:"/appReleaseRestService/getReleaseBasicInfo",data:{}}).then(function(t){T["a"].clear(),e.username=t.data.username,e.userid=t.data.userid,e.urgencyList=t.data.urgencyList,e.urgencySelector=[];for(var i=0;i<e.urgencyList.length;i++)e.urgencySelector.push(e.urgencyList[i].name);e.urgencyLoading=!1,e.originList=t.data.originList,e.originSelector=[];for(var a=0;a<e.originList.length;a++)e.originSelector.push(e.originList[a].orgname);e.originLoading=!1,1===e.originList.length&&(e.origin=e.originList[0]),e.teamList=t.data.teamList,e.teamSelector=[];for(var n=0;n<e.teamList.length;n++)e.teamSelector.push(e.teamList[n].name);e.teamLoading=!1,1===e.teamList.length&&(e.team=e.teamList[0],e.confirmTeam("",0)),e.$route.query.bsid&&e.getInfoData(e.$route.query.bsid)}).catch(function(e){JSON.stringify(e),Object(T["a"])("加载失败，请重新登录")}).finally(function(){})},0)},checkForm:function(){var e={flag:!1,msg:""};return""===this.title?e.msg="请输入标题":""===this.username?e.msg="没有申请人":""===this.release_date?e.msg="请输入发布时间":""===this.urgency?e.msg="请选择优先级":""===this.origin?e.msg="所属部门为空":""===this.team?e.msg="请选择所属团队":""===this.targetSys?e.msg="请选择所属系统":""===this.target_server?e.msg="目标SERVER":""===this.description?e.msg="请输入发布描述":e.flag=!0,e},getInfoData:function(e){var t=this;setTimeout(function(){t.$OmspRequest.sendRequest({url:"/appReleaseRestService/getRelease",data:{id:e}}).then(function(e){t.releaseData=JSON.parse(e.data.result),t.bsid=t.releaseData.id,t.title=t.releaseData.title,t.release_date=t.releaseData.release_date;for(var i=0;i<t.urgencyList.length;i++)t.releaseData.urgency===t.urgencyList[i].id&&(t.urgency=t.urgencyList[i]);for(var a=0;a<t.originList.length;a++)t.releaseData.orgid===t.originList[a].id&&(t.origin=t.originList[a]);for(var n=0;n<t.teamList.length;n++)t.releaseData.team_id===t.teamList[n].id&&t.confirmTeam("",n);t.package_name=t.releaseData.package_name,t.package_version=t.releaseData.package_version,t.target_server=t.releaseData.target_server,t.description=t.releaseData.description;for(var s=0;s<t.releaseData.release_obj_list.length;s++)t.releaseData.release_obj_list[s].change_id&&(t.list.push(t.releaseData.release_obj_list[s]),t.checkBoxResult[s]=t.releaseData.release_obj_list[s].change_id);for(var r=0;r<t.releaseData.no_release_obj_list.length;r++)t.releaseData.no_release_obj_list[r].change_id&&t.list.push(t.releaseData.no_release_obj_list[r])}).catch(function(e){JSON.stringify(e),Object(T["a"])("加载失败，请重新登录")}).finally(function(){})},0)}}},C=R,F=(i("be8b"),i("2877")),B=Object(F["a"])(C,n,s,!1,null,null,null);t["default"]=B.exports},ee83:function(e,t,i){"use strict";var a=i("c31d"),n=i("d282"),s=i("68ed"),r=i("482d"),o=i("96b0"),c=i("1b10"),l=i("f253"),u=Object(a["a"])({},c["a"],{value:null,filter:Function,showToolbar:{type:Boolean,default:!0},formatter:{type:Function,default:function(e,t){return t}}}),h={data:function(){return{innerValue:this.formatValue(this.value)}},computed:{originColumns:function(){var e=this;return this.ranges.map(function(t){var i=t.type,a=t.range,n=Object(o["c"])(a[1]-a[0]+1,function(e){var t=Object(s["b"])(a[0]+e);return t});return e.filter&&(n=e.filter(i,n)),{type:i,values:n}})},columns:function(){var e=this;return this.originColumns.map(function(t){return{values:t.values.map(function(i){return e.formatter(t.type,i)})}})}},watch:{columns:"updateColumnValue",innerValue:function(e){this.$emit("input",e)}},mounted:function(){var e=this;this.updateColumnValue(),this.$nextTick(function(){e.updateInnerValue()})},methods:{getPicker:function(){return this.$refs.picker},onConfirm:function(){this.$emit("confirm",this.innerValue)},onCancel:function(){this.$emit("cancel")}},render:function(){var e=this,t=arguments[0],i={};return Object.keys(c["a"]).forEach(function(t){i[t]=e[t]}),t(l["a"],{ref:"picker",attrs:{columns:this.columns},on:{change:this.onChange,confirm:this.onConfirm,cancel:this.onCancel},props:Object(a["a"])({},i)})}},d=Object(n["a"])("time-picker"),g=d[0],m=g({mixins:[h],props:Object(a["a"])({},u,{minHour:{type:[Number,String],default:0},maxHour:{type:[Number,String],default:23},minMinute:{type:[Number,String],default:0},maxMinute:{type:[Number,String],default:59}}),computed:{ranges:function(){return[{type:"hour",range:[+this.minHour,+this.maxHour]},{type:"minute",range:[+this.minMinute,+this.maxMinute]}]}},watch:{filter:"updateInnerValue",minHour:"updateInnerValue",maxHour:"updateInnerValue",minMinute:"updateInnerValue",maxMinute:"updateInnerValue",value:function(e){e=this.formatValue(e),e!==this.innerValue&&(this.innerValue=e,this.updateColumnValue(e))}},methods:{formatValue:function(e){e||(e=Object(s["b"])(this.minHour)+":"+Object(s["b"])(this.minMinute));var t=e.split(":"),i=t[0],a=t[1];return i=Object(s["b"])(Object(r["a"])(i,this.minHour,this.maxHour)),a=Object(s["b"])(Object(r["a"])(a,this.minMinute,this.maxMinute)),i+":"+a},updateInnerValue:function(){var e=this.getPicker().getIndexes(),t=e[0],i=e[1],a=this.originColumns,n=a[0],s=a[1],r=n.values[t]||n.values[0],o=s.values[i]||s.values[0];this.innerValue=this.formatValue(r+":"+o)},onChange:function(e){var t=this;this.updateInnerValue(),this.$nextTick(function(){t.$nextTick(function(){t.$emit("change",e)})})},updateColumnValue:function(){var e=this,t=this.formatter,i=this.innerValue.split(":"),a=[t("hour",i[0]),t("minute",i[1])];this.$nextTick(function(){e.getPicker().setValues(a)})}}}),f=i("bad1"),p=(new Date).getFullYear(),b=Object(n["a"])("date-picker"),v=b[0],y=v({mixins:[h],props:Object(a["a"])({},u,{type:{type:String,default:"datetime"},minDate:{type:Date,default:function(){return new Date(p-10,0,1)},validator:f["a"]},maxDate:{type:Date,default:function(){return new Date(p+10,11,31)},validator:f["a"]}}),watch:{filter:"updateInnerValue",minDate:"updateInnerValue",maxDate:"updateInnerValue",value:function(e){e=this.formatValue(e),e.valueOf()!==this.innerValue.valueOf()&&(this.innerValue=e)}},computed:{ranges:function(){var e=this.getBoundary("max",this.innerValue),t=e.maxYear,i=e.maxDate,a=e.maxMonth,n=e.maxHour,s=e.maxMinute,r=this.getBoundary("min",this.innerValue),o=r.minYear,c=r.minDate,l=r.minMonth,u=r.minHour,h=r.minMinute,d=[{type:"year",range:[o,t]},{type:"month",range:[l,a]},{type:"day",range:[c,i]},{type:"hour",range:[u,n]},{type:"minute",range:[h,s]}];return"date"===this.type&&d.splice(3,2),"year-month"===this.type&&d.splice(2,3),d}},methods:{formatValue:function(e){return Object(f["a"])(e)||(e=this.minDate),e=Math.max(e,this.minDate.getTime()),e=Math.min(e,this.maxDate.getTime()),new Date(e)},getBoundary:function(e,t){var i,a=this[e+"Date"],n=a.getFullYear(),s=1,r=1,c=0,l=0;return"max"===e&&(s=12,r=Object(o["a"])(t.getFullYear(),t.getMonth()+1),c=23,l=59),t.getFullYear()===n&&(s=a.getMonth()+1,t.getMonth()+1===s&&(r=a.getDate(),t.getDate()===r&&(c=a.getHours(),t.getHours()===c&&(l=a.getMinutes())))),i={},i[e+"Year"]=n,i[e+"Month"]=s,i[e+"Date"]=r,i[e+"Hour"]=c,i[e+"Minute"]=l,i},updateInnerValue:function(){var e,t=this,i=this.getPicker().getIndexes(),a=function(e){var a=t.originColumns[e].values;return Object(o["b"])(a[i[e]])},n=a(0),s=a(1),r=Object(o["a"])(n,s);e="year-month"===this.type?1:a(2),e=e>r?r:e;var c=0,l=0;"datetime"===this.type&&(c=a(3),l=a(4));var u=new Date(n,s-1,e,c,l);this.innerValue=this.formatValue(u)},onChange:function(e){var t=this;this.updateInnerValue(),this.$nextTick(function(){t.$nextTick(function(){t.$emit("change",e)})})},updateColumnValue:function(){var e=this,t=this.innerValue,i=this.formatter,a=[i("year",""+t.getFullYear()),i("month",Object(s["b"])(t.getMonth()+1)),i("day",Object(s["b"])(t.getDate()))];"datetime"===this.type&&a.push(i("hour",Object(s["b"])(t.getHours())),i("minute",Object(s["b"])(t.getMinutes()))),"year-month"===this.type&&(a=a.slice(0,2)),this.$nextTick(function(){e.getPicker().setValues(a)})}}}),k=Object(n["a"])("datetime-picker"),x=k[0],S=k[1];t["a"]=x({props:Object(a["a"])({},m.props,{},y.props),render:function(){var e=arguments[0],t="time"===this.type?m:y;return e(t,{class:S(),props:Object(a["a"])({},this.$props),on:Object(a["a"])({},this.$listeners)})}})},f6a1:function(e,t,i){},ff04:function(e,t,i){}}]);