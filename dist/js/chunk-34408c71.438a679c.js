(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-34408c71"],{"162c":function(e,t,i){},"21ab":function(e,t,i){"use strict";var n=i("c31d"),a=i("d282"),r=i("ea8e"),o=i("b1d2"),s=i("48f4"),c=i("9884"),l=i("6f2f"),u=i("ad06"),d=Object(a["a"])("grid-item"),g=d[0],h=d[1];t["a"]=g({mixins:[Object(c["a"])("vanGrid")],props:Object(n["a"])({},s["c"],{dot:Boolean,text:String,icon:String,info:[Number,String]}),computed:{style:function(){var e=this.parent,t=e.square,i=e.gutter,n=e.columnNum,a=100/n+"%",o={flexBasis:a};if(t)o.paddingTop=a;else if(i){var s=Object(r["a"])(i);o.paddingRight=s,this.index>=n&&(o.marginTop=s)}return o},contentStyle:function(){var e=this.parent,t=e.square,i=e.gutter;if(t&&i){var n=Object(r["a"])(i);return{right:n,bottom:n,height:"auto"}}}},methods:{onClick:function(e){this.$emit("click",e),Object(s["b"])(this.$router,this)},genIcon:function(){var e=this.$createElement,t=this.slots("icon");return t?e("div",{class:h("icon-wrapper")},[t,e(l["a"],{attrs:{dot:this.dot,info:this.info}})]):this.icon?e(u["a"],{attrs:{name:this.icon,dot:this.dot,info:this.info,size:this.parent.iconSize},class:h("icon")}):void 0},getText:function(){var e=this.$createElement,t=this.slots("text");return t||(this.text?e("span",{class:h("text")},[this.text]):void 0)},genContent:function(){var e=this.slots();return e||[this.genIcon(),this.getText()]}},render:function(){var e,t=arguments[0],i=this.parent,n=i.center,a=i.border,r=i.square,s=i.gutter,c=i.clickable;return t("div",{class:[h({square:r})],style:this.style},[t("div",{style:this.contentStyle,attrs:{role:c?"button":null,tabindex:c?0:null},class:[h("content",{center:n,square:r,clickable:c,surround:a&&s}),(e={},e[o["b"]]=a,e)],on:{click:this.onClick}},[this.genContent()])])}})},2830:function(e,t,i){"use strict";var n=i("d282"),a=i("ea8e"),r=i("b1d2"),o=i("9884"),s=Object(n["a"])("grid"),c=s[0],l=s[1];t["a"]=c({mixins:[Object(o["b"])("vanGrid")],props:{square:Boolean,gutter:[Number,String],iconSize:[Number,String],clickable:Boolean,columnNum:{type:[Number,String],default:4},center:{type:Boolean,default:!0},border:{type:Boolean,default:!0}},computed:{style:function(){var e=this.gutter;if(e)return{paddingLeft:Object(a["a"])(e)}}},render:function(){var e,t=arguments[0];return t("div",{style:this.style,class:[l(),(e={},e[r["f"]]=this.border&&!this.gutter,e)]},[this.slots()])}})},"392b":function(e,t,i){},4072:function(e,t,i){"use strict";i("3cd0"),i("162c")},"578d":function(e,t,i){"use strict";i("3cd0"),i("25bb"),i("f8c2")},6762:function(e,t,i){"use strict";var n=i("5ca1"),a=i("c366")(!0);n(n.P,"Array",{includes:function(e){return a(this,e,arguments.length>1?arguments[1]:void 0)}}),i("9c6c")("includes")},"7bd9":function(e,t,i){"use strict";var n=i("d282"),a=i("1325"),r=i("b1d2"),o=i("5fbe"),s=i("3875"),c=Object(n["a"])("key"),l=c[0],u=c[1],d=l({mixins:[s["a"]],props:{type:String,text:[Number,String],theme:{type:Array,default:function(){return[]}}},data:function(){return{active:!1}},computed:{className:function(){var e=this.theme.slice(0);return this.active&&e.push("active"),this.type&&e.push(this.type),u(e)}},mounted:function(){this.bindTouchEvent(this.$el)},methods:{onTouchStart:function(e){e.stopPropagation(),this.touchStart(e),this.active=!0},onTouchMove:function(e){this.touchMove(e),this.direction&&(this.active=!1)},onTouchEnd:function(){this.active&&(this.active=!1,this.$emit("press",this.text,this.type))}},render:function(){var e=arguments[0];return e("i",{attrs:{role:"button",tabindex:"0"},class:[r["b"],this.className]},[this.slots("default")||this.text])}}),g=Object(n["a"])("number-keyboard"),h=g[0],m=g[1],f=g[2],p=["blue","big"],b=["delete","big","gray"];t["a"]=h({mixins:[Object(o["a"])(function(e){this.hideOnClickOutside&&e(document.body,"touchstart",this.onBlur)})],model:{event:"update:value"},props:{show:Boolean,title:String,zIndex:[Number,String],closeButtonText:String,deleteButtonText:String,theme:{type:String,default:"default"},value:{type:String,default:""},extraKey:{type:String,default:""},maxlength:{type:[Number,String],default:Number.MAX_VALUE},transition:{type:Boolean,default:!0},showDeleteKey:{type:Boolean,default:!0},hideOnClickOutside:{type:Boolean,default:!0},safeAreaInsetBottom:{type:Boolean,default:!0}},watch:{show:function(e){this.transition||this.$emit(e?"show":"hide")}},computed:{keys:function(){for(var e=[],t=1;t<=9;t++)e.push({text:t});switch(this.theme){case"default":e.push({text:this.extraKey,theme:["gray"],type:"extra"},{text:0},{text:this.deleteText,theme:["gray"],type:"delete"});break;case"custom":e.push({text:0,theme:["middle"]},{text:this.extraKey,type:"extra"});break}return e},deleteText:function(){return this.deleteButtonText||f("delete")}},methods:{onBlur:function(){this.show&&this.$emit("blur")},onClose:function(){this.$emit("close"),this.onBlur()},onAnimationEnd:function(){this.$emit(this.show?"show":"hide")},onPress:function(e,t){if(""!==e){var i=this.value;"delete"===t?(this.$emit("delete"),this.$emit("update:value",i.slice(0,i.length-1))):"close"===t?this.onClose():i.length<this.maxlength&&(this.$emit("input",e),this.$emit("update:value",i+e))}},genTitle:function(){var e=this.$createElement,t=this.title,i=this.theme,n=this.closeButtonText,a=this.slots("title-left"),o=n&&"default"===i,s=t||o||a;if(s)return e("div",{class:[m("title"),r["f"]]},[a&&e("span",{class:m("title-left")},[a]),t&&e("span",[t]),o&&e("span",{attrs:{role:"button",tabindex:"0"},class:m("close"),on:{click:this.onClose}},[n])])},genKeys:function(){var e=this,t=this.$createElement;return this.keys.map(function(i){return t(d,{key:i.text,attrs:{text:i.text,type:i.type,theme:i.theme},on:{press:e.onPress}},["delete"===i.type&&e.slots("delete"),"extra"===i.type&&e.slots("extra-key")])})},genSidebar:function(){var e=this.$createElement;if("custom"===this.theme)return e("div",{class:m("sidebar")},[e(d,{attrs:{text:this.deleteText,type:"delete",theme:b},on:{press:this.onPress}},[this.slots("delete")]),e(d,{attrs:{text:this.closeButtonText,type:"close",theme:p},on:{press:this.onPress}})])}},render:function(){var e=arguments[0];return e("transition",{attrs:{name:this.transition?"van-slide-up":""}},[e("div",{directives:[{name:"show",value:this.show}],style:{zIndex:this.zIndex},class:m([this.theme,{"safe-area-inset-bottom":this.safeAreaInsetBottom}]),on:{touchstart:a["d"],animationend:this.onAnimationEnd,webkitAnimationEnd:this.onAnimationEnd}},[this.genTitle(),e("div",{class:m("body")},[this.genKeys(),this.genSidebar()])])])}})},"81a6":function(e,t,i){"use strict";i("3cd0"),i("f6a1")},"96b0":function(e,t,i){"use strict";i.d(t,"c",function(){return a}),i.d(t,"b",function(){return r}),i.d(t,"a",function(){return o});var n=i("90c6");function a(e,t){var i=-1,n=Array(e);while(++i<e)n[i]=t(i);return n}function r(e){if(!e)return 0;while(Object(n["a"])(parseInt(e,10))){if(!(e.length>1))return 0;e=e.slice(1)}return parseInt(e,10)}function o(e,t){return 32-new Date(e,t-1,32).getDate()}},a035:function(e,t,i){"use strict";i("3cd0"),i("1a44"),i("acc2"),i("ff04")},a156:function(e,t,i){"use strict";var n=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("ckeditor",e._b({attrs:{editor:e.editor,config:e.editorConfig},model:{value:e.editorData,callback:function(t){e.editorData=t},expression:"editorData"}},"ckeditor",e.$attrs,!1))},a=[],r={name:"OmspEditor",components:{},props:{value:{type:String,default:""}},data:function(){return{editor:this.$OmspClassicEditor,editorData:"",editorConfig:{placeholder:"请输入······",toolbar:[]}}},watch:{value:function(e){this.editorData=e},editorData:function(e){this.$emit("input",e)}},mounted:function(){this.editorData=this.value}},o=r,s=i("2877"),c=Object(s["a"])(o,n,a,!1,null,"83061b96",null);t["a"]=c.exports},bad1:function(e,t,i){"use strict";i.d(t,"a",function(){return a});var n=i("90c6");function a(e){return"[object Date]"===Object.prototype.toString.call(e)&&!Object(n["a"])(e.getTime())}},da93:function(e,t,i){"use strict";i.r(t);var n,a=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",[i("div",{staticClass:"omsp-eventregist",attrs:{id:"omspeventregist"}},[i("van-nav-bar",{staticClass:"omsp-nav-bar",attrs:{title:"事件登记","left-text":"返回","left-arrow":"",fixed:""},on:{"click-left":e.backToIndex}}),i("div",{staticClass:"omsp-eventregist-body"},[i("van-tabs",{attrs:{"lazy-render":!1},model:{value:e.tabNum,callback:function(t){e.tabNum=t},expression:"tabNum"}},[i("van-tab",{attrs:{title:"基本信息"}},[i("van-cell-group",[i("van-field",{attrs:{"input-align":"right",clearable:"",label:"事件标题",placeholder:"请输入",clickable:"",required:""},model:{value:e.title,callback:function(t){e.title=t},expression:"title"}}),i("van-field",{attrs:{"input-align":"right",clearable:"",label:"发生时间",placeholder:"点击选择时间",clickable:"",readonly:"",required:""},on:{click:function(t){e.showOccurDatePickerFlag=!0}},model:{value:e.occurDate,callback:function(t){e.occurDate=t},expression:"occurDate"}}),i("van-field",{attrs:{"input-align":"right",clearable:"",label:"申请人",placeholder:"请输入",clickable:"",readonly:"",required:""},model:{value:e.username,callback:function(t){e.username=t},expression:"username"}}),i("van-field",{attrs:{"input-align":"right",clearable:"",label:"申请人电话",placeholder:"请输入",clickable:"",readonly:"",required:""},on:{click:function(t){e.showCreatUserTelKeyboard=!0}},model:{value:e.creatUserTel,callback:function(t){e.creatUserTel=t},expression:"creatUserTel"}}),i("van-field",{attrs:{"input-align":"right",clearable:"",label:"所属部门",placeholder:"点击选择所属部门","default-index":"0",clickable:"","right-icon":"arrow",readonly:"",required:""},on:{click:function(t){e.showOriginSelectorFlag=!0}},model:{value:e.origin.name,callback:function(t){e.$set(e.origin,"name",t)},expression:"origin.name"}}),i("van-field",{attrs:{"input-align":"right",clearable:"",label:"紧急度",placeholder:"点击选择紧急度",clickable:"","right-icon":"arrow",readonly:"",required:""},on:{click:function(t){e.showUrgencySelectorFlag=!0}},model:{value:e.urgency.name,callback:function(t){e.$set(e.urgency,"name",t)},expression:"urgency.name"}}),i("van-field",{attrs:{"input-align":"right",clearable:"",label:"事件分类",placeholder:"点击选择事件类型",clickable:"","right-icon":"arrow",readonly:"",required:""},on:{click:function(t){e.showCategorySelectorFlag=!0}},model:{value:e.category.name,callback:function(t){e.$set(e.category,"name",t)},expression:"category.name"}}),i("van-field",{attrs:{"input-align":"right",clearable:"",label:"事件级别",placeholder:"点击选择事件级别",clickable:"","right-icon":"arrow",readonly:"",required:""},on:{click:function(t){e.showIncidentLevelSelectorFlag=!0}},model:{value:e.incidentLevel.name,callback:function(t){e.$set(e.incidentLevel,"name",t)},expression:"incidentLevel.name"}}),i("van-field",{attrs:{"input-align":"right",clearable:"",label:"所属团队",placeholder:"点击选择所属团队",clickable:"","right-icon":"arrow",readonly:"",required:""},on:{click:function(t){e.showTeamSelectorFlag=!0}},model:{value:e.team.name,callback:function(t){e.$set(e.team,"name",t)},expression:"team.name"}}),i("van-field",{attrs:{"input-align":"right",clearable:"",label:"所属系统",placeholder:"点击选择所属系统",clickable:"","right-icon":"arrow",readonly:"",required:""},on:{click:function(t){e.showTargetSysSelectorFlag=!0}},model:{value:e.targetSys.name,callback:function(t){e.$set(e.targetSys,"name",t)},expression:"targetSys.name"}})],1),i("van-cell-group",[i("van-panel",{attrs:{title:"事件描述",icon:"comment"}},[i("omsp-editor",{model:{value:e.editorData,callback:function(t){e.editorData=t},expression:"editorData"}})],1)],1)],1),i("van-tab",{attrs:{title:"附件管理"}},[i("task-file",{ref:"omspFile",attrs:{bsid:e.bsid||e.$route.params.bsid,biz_code:e.biz_code}})],1)],1)],1),i("div",{staticClass:"omsp-eventregist-foot"},[i("div",{staticClass:"omsp-eventregist-foot-grid"},[i("div",{staticClass:"omsp-eventregist-foot-grid-item",staticStyle:{"background-color":"#1A88E9"}},[i("div",{staticClass:"omsp-eventregist-foot-grid-item-center",on:{click:function(t){return e.save("commit")}}},[i("span",{staticClass:"omsp-eventregist-foot-grid-item-center-text"},[e._v("提交")])])]),i("div",{staticClass:"omsp-eventregist-foot-grid-item",staticStyle:{"background-color":"#BBBCC2"}},[i("div",{staticClass:"omsp-eventregist-foot-grid-item-center",on:{click:function(t){return e.save("draft")}}},[i("span",{staticClass:"omsp-eventregist-foot-grid-item-center-text"},[e._v("存为草稿")])])])])]),i("van-popup",{attrs:{position:"bottom"},model:{value:e.showOccurDatePickerFlag,callback:function(t){e.showOccurDatePickerFlag=t},expression:"showOccurDatePickerFlag"}},[i("van-datetime-picker",{attrs:{type:"datetime","min-date":e.minOccurDate,"max-date":e.maxOccurDate},on:{confirm:e.confirmOccurDate,cancel:function(t){e.showOccurDatePickerFlag=!1}},model:{value:e.pickingOccurDate,callback:function(t){e.pickingOccurDate=t},expression:"pickingOccurDate"}})],1),i("van-number-keyboard",{attrs:{show:e.showCreatUserTelKeyboard,theme:"custom","extra-key":".","close-button-text":"完成"},on:{blur:function(t){e.showCreatUserTelKeyboard=!1}},model:{value:e.creatUserTel,callback:function(t){e.creatUserTel=t},expression:"creatUserTel"}}),i("van-popup",{attrs:{position:"bottom"},model:{value:e.showOriginSelectorFlag,callback:function(t){e.showOriginSelectorFlag=t},expression:"showOriginSelectorFlag"}},[i("van-picker",{attrs:{loading:e.originLoading,columns:e.originSelector,"show-toolbar":"",title:"所属部门"},on:{cancel:function(t){e.showOriginSelectorFlag=!1},confirm:e.confirmOrigin,change:e.changeOrigin}})],1),i("van-popup",{attrs:{position:"bottom"},model:{value:e.showUrgencySelectorFlag,callback:function(t){e.showUrgencySelectorFlag=t},expression:"showUrgencySelectorFlag"}},[i("van-picker",{attrs:{loading:e.urgencyLoading,columns:e.urgencySelector,"show-toolbar":"",title:"紧急度"},on:{cancel:function(t){e.showUrgencySelectorFlag=!1},confirm:e.confirmUrgency}})],1),i("van-popup",{attrs:{position:"bottom"},model:{value:e.showCategorySelectorFlag,callback:function(t){e.showCategorySelectorFlag=t},expression:"showCategorySelectorFlag"}},[i("van-picker",{attrs:{loading:e.categoryLoading,columns:e.categorySelector,"show-toolbar":"",title:"事件分类"},on:{cancel:function(t){e.showCategorySelectorFlag=!1},confirm:e.confirmCategory}})],1),i("van-popup",{attrs:{position:"bottom"},model:{value:e.showIncidentLevelSelectorFlag,callback:function(t){e.showIncidentLevelSelectorFlag=t},expression:"showIncidentLevelSelectorFlag"}},[i("van-picker",{attrs:{loading:e.incidentLevelLoading,columns:e.incidentLevelSelector,"show-toolbar":"",title:"事件级别"},on:{cancel:function(t){e.showIncidentLevelSelectorFlag=!1},confirm:e.confirmIncidentLevel}})],1),i("van-popup",{attrs:{position:"bottom"},model:{value:e.showTeamSelectorFlag,callback:function(t){e.showTeamSelectorFlag=t},expression:"showTeamSelectorFlag"}},[i("van-picker",{attrs:{loading:e.teamLoading,columns:e.teamSelector,"show-toolbar":"",title:"所属团队"},on:{cancel:function(t){e.showTeamSelectorFlag=!1},confirm:e.confirmTeam}})],1),i("van-popup",{attrs:{position:"bottom"},model:{value:e.showTargetSysSelectorFlag,callback:function(t){e.showTargetSysSelectorFlag=t},expression:"showTargetSysSelectorFlag"}},[i("van-picker",{attrs:{loading:e.targetSysLoading,columns:e.targetSysSelector,"show-toolbar":"",title:"所属系统"},on:{cancel:function(t){e.showTargetSysSelectorFlag=!1},confirm:e.confirmTargetSys}})],1)],1)])},r=[],o=(i("7514"),i("47e2"),i("2241")),s=(i("6762"),i("bd86")),c=(i("558f"),i("0b33")),l=(i("8990"),i("5e46")),u=(i("d707"),i("8f80")),d=(i("a035"),i("21ab")),g=(i("4072"),i("2830")),h=(i("2a53"),i("34e9")),m=(i("3ec1"),i("7744")),f=(i("8e11"),i("f253")),p=(i("81a6"),i("7bd9")),b=(i("c625"),i("b650")),y=(i("87d0"),i("e41f")),v=(i("578d"),i("ee83")),S=(i("aa1f"),i("ea47")),w=(i("9eda"),i("565f")),k=(i("433b"),i("d399")),x=(i("da02"),i("6b41")),L=i("0ed4"),O=i("a156"),_={name:"AddIncident",components:(n={OmspEditor:O["a"]},Object(s["a"])(n,x["a"].name,x["a"]),Object(s["a"])(n,k["a"].name,k["a"]),Object(s["a"])(n,w["a"].name,w["a"]),Object(s["a"])(n,S["a"].name,S["a"]),Object(s["a"])(n,v["a"].name,v["a"]),Object(s["a"])(n,y["a"].name,y["a"]),Object(s["a"])(n,b["a"].name,b["a"]),Object(s["a"])(n,p["a"].name,p["a"]),Object(s["a"])(n,f["a"].name,f["a"]),Object(s["a"])(n,m["a"].name,m["a"]),Object(s["a"])(n,h["a"].name,h["a"]),Object(s["a"])(n,g["a"].name,g["a"]),Object(s["a"])(n,d["a"].name,d["a"]),Object(s["a"])(n,u["a"].name,u["a"]),Object(s["a"])(n,l["a"].name,l["a"]),Object(s["a"])(n,c["a"].name,c["a"]),Object(s["a"])(n,"TaskFile",L["a"]),n),data:function(){return{incidentData:{},biz_code:"SJ",tabNum:0,bsid:"",title:"",userid:"",username:"",showOccurDatePickerFlag:!1,minOccurDate:new Date(2e3,0,1),maxOccurDate:new Date,pickingOccurDate:new Date,occurDate:"",showCreatUserTelKeyboard:!1,creatUserTel:"",origin:"",showOriginSelectorFlag:!1,originLoading:!0,originSelector:[],originList:[],urgency:"",showUrgencySelectorFlag:!1,urgencyLoading:!0,urgencySelector:[],urgencyList:[],category:"",showCategorySelectorFlag:!1,categoryLoading:!0,categorySelector:[],categoryList:[],incidentLevel:"",showIncidentLevelSelectorFlag:!1,incidentLevelLoading:!0,incidentLevelSelector:[],incidentLevelList:[],team:"",showTeamSelectorFlag:!1,teamLoading:!0,teamSelector:[],teamList:[],showTargetSysSelectorFlag:!1,targetSysSelector:[],targetSys:"",targetSysLoading:!0,targetSysList:[],editorData:"",source:{},sourceList:[],wtSource:{},wtSourceList:[],imgPreviewList:[],imgFileList:[]}},computed:{},mounted:function(){this.confirmOccurDate(new Date),this.getBasicInfo()},methods:{backToIndex:function(){this.$router.slid="right",this.$router.back()},confirmOccurDate:function(e){var t=e.getMonth()+1;this.occurDate=e.getFullYear()+"-"+(t>9?t:"0"+t)+"-"+(e.getDate()>9?e.getDate():"0"+e.getDate())+" "+(e.getHours()>9?e.getHours():"0"+e.getHours())+":"+(e.getMinutes()>9?e.getMinutes():"0"+e.getMinutes())+":00",this.showOccurDatePickerFlag=!1},changeOrigin:function(e,t,i){},confirmOrigin:function(e,t){this.origin=this.originList[t],this.showOriginSelectorFlag=!1},confirmUrgency:function(e,t){this.urgency=this.urgencyList[t],this.showUrgencySelectorFlag=!1},confirmCategory:function(e,t){this.category=this.categoryList[t],this.showCategorySelectorFlag=!1},confirmIncidentLevel:function(e,t){this.incidentLevel=this.incidentLevelList[t],this.showIncidentLevelSelectorFlag=!1},confirmTeam:function(e,t){var i=this;this.team=this.teamList[t],this.showTeamSelectorFlag=!1,setTimeout(function(){i.$OmspRequest.sendRequest({url:"/appTaskRestService/getTargetSys",data:{team_id:i.team.id}}).then(function(e){i.targetSys=[],i.targetSysList=e.data.targetSysList,i.targetSysSelector=[];for(var t=0;t<i.targetSysList.length;t++)i.targetSysSelector.push(i.targetSysList[t].name);1===i.targetSysList.length&&(i.targetSys=i.targetSysList[0]),i.targetSysLoading=!1,setTimeout(function(){for(var e=0;e<i.targetSysList.length;e++)i.incidentData.target_sys===i.targetSysList[e].id&&(i.targetSys=i.targetSysList[e])},0)}).catch(function(e){JSON.stringify(e),Object(k["a"])("获取所属系统失败")}).finally(function(){})},0)},confirmTargetSys:function(e,t){"number"===typeof t&&(this.targetSys=this.targetSysList[t]),this.showTargetSysSelectorFlag=!1},beforeReadImg:function(e){var t=e.type,i=["image/png","image/jpeg"];return!!i.includes(t)||(k["a"].fail("请上传:png、jpeg的图片格式"),!1)},afterReadImg:function(e){return e},save:function(e){var t=this,i=this.checkForm();i.flag?o["a"].confirm({title:"通知",message:"确定这项操作吗?"}).then(function(){k["a"].loading({mask:!0,forbidClick:!0,duration:0,message:"请稍后..."});var i=t.getFormData();setTimeout(function(){t.$OmspRequest.sendRequest({url:"/appTaskRestService/saveIncident",data:i}).then(function(i){k["a"].clear(),t.bsid=i.data.id,t.$nextTick(function(){t.$store.commit("page/removeCachePageName","OmspIndex"),"draft"===e?t.keepEdit():"commit"===e&&t.submit()})}).catch(function(e){JSON.stringify(e),k["a"].fail("暂存失败")}).finally(function(){})},0)}).catch(function(){}):k["a"].fail(i.msg)},keepEdit:function(){var e=this;o["a"].confirm({title:"暂存成功",message:"是否继续修改？"}).then(function(){}).catch(function(){setTimeout(function(){e.$router.push({path:"index"})})})},submit:function(){var e=this;k["a"].loading({mask:!0,forbidClick:!0,duration:0,message:"提交中，请稍后..."});var t=this.getFormData();setTimeout(function(){e.$OmspRequest.sendRequest({url:"/appTaskRestService/submitIncident",data:{id:t.id}}).then(function(t){k["a"].clear(),o["a"].alert({message:"提交成功，即将返回主页"}).then(function(){e.$store.commit("page/removeCachePageName","OmspIndex"),setTimeout(function(){e.$router.push({path:"index"})})})}).catch(function(e){JSON.stringify(e),k["a"].fail("提交失败")}).finally(function(){})},0)},getFormData:function(){var e={bg_change_type:"",wt_source_desc:this.wtSource.name,urgency_desc:this.urgency.name,bg_orgname:"",is_view:"",bg_applicant_phone:"",wt_target_sys:"",source:"01",team_id:this.team.id,wt_occur_frequency_desc:"",incident_level:this.incidentLevel.id,wt_register:"",bg_target_sys_desc:"",category_desc:this.category.name,target_sys:this.targetSys.id,bg_team_id_desc:"",id:this.bsid,bg_urgency:"",bg_urgency_desc:"",bg_team_id:"",orgid:this.origin.id,wt_registe_date:"",occur_date:this.occurDate,wt_team_id_desc:"",bg_category_desc:"",plan_finish_date:"",wt_team_id:"",bg_change_plan:"",wt_urgency:"",org_id:this.origin.id,wt_urgency_desc:"",bg_category:"",bg_effect_scope:"",bg_applicant:"",incident_level_desc:this.incidentLevel.name,bg_id:"",description:this.editorData,title:this.title,wt_again_occur_risk:"",wt_registe_phone:"",is_base:"1",orgname:"",urgency:this.urgency.id,is_draft:"1",source_desc:this.source.name,bg_change_type_desc:"",wt_title:"",bg_title:"",wt_category:"",bg_target_sys:"",wt_category_desc:"",wt_source:this.wtSource.id,pos_orgname:this.origin.orgname,applicant_phone:this.creatUserTel,team_id_desc:this.team.name,applicant:this.username,wt_target_sys_desc:"",menuid:"",category:this.category.id,wt_occur_frequency:"",wt_orgname:"",target_sys_desc:this.targetSys.name,wt_id:""};return e},getBasicInfo:function(){var e=this;Object(k["a"])({type:"loading",overlay:!0,message:"加载中...",duration:0,forbidClick:!0}),setTimeout(function(){e.$OmspRequest.sendRequest({url:"/appTaskRestService/getTaskBasicInfo",data:{}}).then(function(t){k["a"].clear(),e.username=t.data.username,e.userid=t.data.userid,e.originList=t.data.originList,e.originSelector=[];for(var i=0;i<e.originList.length;i++)e.originSelector.push(e.originList[i].name);e.originLoading=!1,1===e.originList.length&&(e.origin=e.originList[0]),e.urgencySelector=[],e.urgencyList=t.data.urgencyList;for(var n=0;n<e.urgencyList.length;n++)e.urgencySelector.push(e.urgencyList[n].name);e.urgencyLoading=!1,e.categorySelector=[],e.categoryList=t.data.categoryList;for(var a=0;a<e.categoryList.length;a++)e.categorySelector.push(e.categoryList[a].name);e.categoryLoading=!1,e.incidentLevelSelector=[],e.incidentLevelList=t.data.incidentLevelList;for(var r=0;r<e.incidentLevelList.length;r++)e.incidentLevelSelector.push(e.incidentLevelList[r].name);e.incidentLevelLoading=!1,e.teamList=t.data.teamList,e.teamSelector=[];for(var o=0;o<e.teamList.length;o++)e.teamSelector.push(e.teamList[o].name);e.teamLoading=!1,1===e.teamList.length&&(e.team=e.teamList[0],e.confirmTeam("",0)),e.sourceList=t.data.incidentSource,e.source=e.sourceList.find(function(e){return"02"===e.id}),e.wtSourceList=t.data.problemSource,e.wtSource=e.wtSourceList.find(function(e){return"02"===e.id}),e.$route.query.bsid&&(e.bsid=e.$route.query.bsid,e.getInfoData(e.bsid))}).catch(function(e){JSON.stringify(e),Object(k["a"])("加载基础数据失败")}).finally(function(){})},0)},checkForm:function(){var e={flag:!1,msg:""};return""===this.title?e.msg="请输入标题":""===this.occurDate?e.msg="请输入发生时间":""===this.username?e.msg="没有申请人":""===this.creatUserTel?e.msg="请输入申请人电话":""===this.origin?e.msg="所属部门为空":""===this.urgency?e.msg="请选择紧急度":""===this.category?e.msg="请选择事件分类":""===this.incidentLevel?e.msg="请选择事件级别":""===this.team?e.msg="请选择所属团队":""===this.targetSys?e.msg="请选择所属系统":""===this.editorData?e.msg="请输入事件描述":e.flag=!0,e},getInfoData:function(e){var t=this;setTimeout(function(){t.$OmspRequest.sendRequest({url:"/appTaskRestService/getIncident",data:{id:e}}).then(function(e){t.incidentData=JSON.parse(e.data.incidentData),t.bsid=t.incidentData.id,t.title=t.incidentData.title,t.pickingOccurDate=t.incidentData.occur_date,t.occurDate=t.incidentData.occur_date,t.creatUserTel=t.incidentData.applicant_phone;for(var i=0;i<t.originList.length;i++)t.incidentData.orgid===t.originList[i].id&&(t.origin=t.originList[i]);for(var n=0;n<t.categoryList.length;n++)t.incidentData.category===t.categoryList[n].id&&(t.category=t.categoryList[n]);for(var a=0;a<t.urgencyList.length;a++)t.incidentData.urgency===t.urgencyList[a].id&&(t.urgency=t.urgencyList[a]);for(var r=0;r<t.incidentLevelList.length;r++)t.incidentData.incident_level===t.incidentLevelList[r].id&&(t.incidentLevel=t.incidentLevelList[r]);for(var o=0;o<t.teamList.length;o++)t.incidentData.team_id===t.teamList[o].id&&t.confirmTeam("",o);t.editorData=t.incidentData.description}).catch(function(e){console.log(e),JSON.stringify(e),Object(k["a"])("加载失败，请重新登录")}).finally(function(){})},0)}}},D=_,T=(i("de15"),i("2877")),j=Object(T["a"])(D,a,r,!1,null,"21926696",null);t["default"]=j.exports},de15:function(e,t,i){"use strict";var n=i("392b"),a=i.n(n);a.a},ee83:function(e,t,i){"use strict";var n=i("c31d"),a=i("d282"),r=i("68ed"),o=i("482d"),s=i("96b0"),c=i("1b10"),l=i("f253"),u=Object(n["a"])({},c["a"],{value:null,filter:Function,showToolbar:{type:Boolean,default:!0},formatter:{type:Function,default:function(e,t){return t}}}),d={data:function(){return{innerValue:this.formatValue(this.value)}},computed:{originColumns:function(){var e=this;return this.ranges.map(function(t){var i=t.type,n=t.range,a=Object(s["c"])(n[1]-n[0]+1,function(e){var t=Object(r["b"])(n[0]+e);return t});return e.filter&&(a=e.filter(i,a)),{type:i,values:a}})},columns:function(){var e=this;return this.originColumns.map(function(t){return{values:t.values.map(function(i){return e.formatter(t.type,i)})}})}},watch:{columns:"updateColumnValue",innerValue:function(e){this.$emit("input",e)}},mounted:function(){var e=this;this.updateColumnValue(),this.$nextTick(function(){e.updateInnerValue()})},methods:{getPicker:function(){return this.$refs.picker},onConfirm:function(){this.$emit("confirm",this.innerValue)},onCancel:function(){this.$emit("cancel")}},render:function(){var e=this,t=arguments[0],i={};return Object.keys(c["a"]).forEach(function(t){i[t]=e[t]}),t(l["a"],{ref:"picker",attrs:{columns:this.columns},on:{change:this.onChange,confirm:this.onConfirm,cancel:this.onCancel},props:Object(n["a"])({},i)})}},g=Object(a["a"])("time-picker"),h=g[0],m=h({mixins:[d],props:Object(n["a"])({},u,{minHour:{type:[Number,String],default:0},maxHour:{type:[Number,String],default:23},minMinute:{type:[Number,String],default:0},maxMinute:{type:[Number,String],default:59}}),computed:{ranges:function(){return[{type:"hour",range:[+this.minHour,+this.maxHour]},{type:"minute",range:[+this.minMinute,+this.maxMinute]}]}},watch:{filter:"updateInnerValue",minHour:"updateInnerValue",maxHour:"updateInnerValue",minMinute:"updateInnerValue",maxMinute:"updateInnerValue",value:function(e){e=this.formatValue(e),e!==this.innerValue&&(this.innerValue=e,this.updateColumnValue(e))}},methods:{formatValue:function(e){e||(e=Object(r["b"])(this.minHour)+":"+Object(r["b"])(this.minMinute));var t=e.split(":"),i=t[0],n=t[1];return i=Object(r["b"])(Object(o["a"])(i,this.minHour,this.maxHour)),n=Object(r["b"])(Object(o["a"])(n,this.minMinute,this.maxMinute)),i+":"+n},updateInnerValue:function(){var e=this.getPicker().getIndexes(),t=e[0],i=e[1],n=this.originColumns,a=n[0],r=n[1],o=a.values[t]||a.values[0],s=r.values[i]||r.values[0];this.innerValue=this.formatValue(o+":"+s)},onChange:function(e){var t=this;this.updateInnerValue(),this.$nextTick(function(){t.$nextTick(function(){t.$emit("change",e)})})},updateColumnValue:function(){var e=this,t=this.formatter,i=this.innerValue.split(":"),n=[t("hour",i[0]),t("minute",i[1])];this.$nextTick(function(){e.getPicker().setValues(n)})}}}),f=i("bad1"),p=(new Date).getFullYear(),b=Object(a["a"])("date-picker"),y=b[0],v=y({mixins:[d],props:Object(n["a"])({},u,{type:{type:String,default:"datetime"},minDate:{type:Date,default:function(){return new Date(p-10,0,1)},validator:f["a"]},maxDate:{type:Date,default:function(){return new Date(p+10,11,31)},validator:f["a"]}}),watch:{filter:"updateInnerValue",minDate:"updateInnerValue",maxDate:"updateInnerValue",value:function(e){e=this.formatValue(e),e.valueOf()!==this.innerValue.valueOf()&&(this.innerValue=e)}},computed:{ranges:function(){var e=this.getBoundary("max",this.innerValue),t=e.maxYear,i=e.maxDate,n=e.maxMonth,a=e.maxHour,r=e.maxMinute,o=this.getBoundary("min",this.innerValue),s=o.minYear,c=o.minDate,l=o.minMonth,u=o.minHour,d=o.minMinute,g=[{type:"year",range:[s,t]},{type:"month",range:[l,n]},{type:"day",range:[c,i]},{type:"hour",range:[u,a]},{type:"minute",range:[d,r]}];return"date"===this.type&&g.splice(3,2),"year-month"===this.type&&g.splice(2,3),g}},methods:{formatValue:function(e){return Object(f["a"])(e)||(e=this.minDate),e=Math.max(e,this.minDate.getTime()),e=Math.min(e,this.maxDate.getTime()),new Date(e)},getBoundary:function(e,t){var i,n=this[e+"Date"],a=n.getFullYear(),r=1,o=1,c=0,l=0;return"max"===e&&(r=12,o=Object(s["a"])(t.getFullYear(),t.getMonth()+1),c=23,l=59),t.getFullYear()===a&&(r=n.getMonth()+1,t.getMonth()+1===r&&(o=n.getDate(),t.getDate()===o&&(c=n.getHours(),t.getHours()===c&&(l=n.getMinutes())))),i={},i[e+"Year"]=a,i[e+"Month"]=r,i[e+"Date"]=o,i[e+"Hour"]=c,i[e+"Minute"]=l,i},updateInnerValue:function(){var e,t=this,i=this.getPicker().getIndexes(),n=function(e){var n=t.originColumns[e].values;return Object(s["b"])(n[i[e]])},a=n(0),r=n(1),o=Object(s["a"])(a,r);e="year-month"===this.type?1:n(2),e=e>o?o:e;var c=0,l=0;"datetime"===this.type&&(c=n(3),l=n(4));var u=new Date(a,r-1,e,c,l);this.innerValue=this.formatValue(u)},onChange:function(e){var t=this;this.updateInnerValue(),this.$nextTick(function(){t.$nextTick(function(){t.$emit("change",e)})})},updateColumnValue:function(){var e=this,t=this.innerValue,i=this.formatter,n=[i("year",""+t.getFullYear()),i("month",Object(r["b"])(t.getMonth()+1)),i("day",Object(r["b"])(t.getDate()))];"datetime"===this.type&&n.push(i("hour",Object(r["b"])(t.getHours())),i("minute",Object(r["b"])(t.getMinutes()))),"year-month"===this.type&&(n=n.slice(0,2)),this.$nextTick(function(){e.getPicker().setValues(n)})}}}),S=Object(a["a"])("datetime-picker"),w=S[0],k=S[1];t["a"]=w({props:Object(n["a"])({},m.props,{},v.props),render:function(){var e=arguments[0],t="time"===this.type?m:v;return e(t,{class:k(),props:Object(n["a"])({},this.$props),on:Object(n["a"])({},this.$listeners)})}})},f6a1:function(e,t,i){},ff04:function(e,t,i){}}]);