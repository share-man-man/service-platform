(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-0a08c1a0"],{"0a26":function(e,t,a){"use strict";a.d(t,"a",(function(){return o}));var i=a("ad06"),n=a("78eb"),s=a("9884"),r=a("ea8e"),o=function(e){var t=e.parent,a=e.bem,o=e.role;return{mixins:[Object(s["a"])(t),n["a"]],props:{name:null,value:null,disabled:Boolean,iconSize:[Number,String],checkedColor:String,labelPosition:String,labelDisabled:Boolean,shape:{type:String,default:"round"},bindGroup:{type:Boolean,default:!0}},computed:{disableBindRelation:function(){return!this.bindGroup},isDisabled:function(){return this.parent&&this.parent.disabled||this.disabled},direction:function(){return this.parent&&this.parent.direction||null},iconStyle:function(){var e=this.checkedColor||this.parent&&this.parent.checkedColor;if(e&&this.checked&&!this.isDisabled)return{borderColor:e,backgroundColor:e}},tabindex:function(){return this.isDisabled||"radio"===o&&!this.checked?-1:0}},methods:{onClick:function(e){var t=this,a=e.target,i=this.$refs.icon,n=i===a||i.contains(a);this.isDisabled||!n&&this.labelDisabled?this.$emit("click",e):(this.toggle(),setTimeout((function(){t.$emit("click",e)})))},genIcon:function(){var e=this.$createElement,t=this.checked,n=this.iconSize||this.parent&&this.parent.iconSize;return e("div",{ref:"icon",class:a("icon",[this.shape,{disabled:this.isDisabled,checked:t}]),style:{fontSize:Object(r["a"])(n)}},[this.slots("icon",{checked:t})||e(i["a"],{attrs:{name:"success"},style:this.iconStyle})])},genLabel:function(){var e=this.$createElement,t=this.slots();if(t)return e("span",{class:a("label",[this.labelPosition,{disabled:this.isDisabled}])},[t])}},render:function(){var e=arguments[0],t=[this.genIcon()];return"left"===this.labelPosition?t.unshift(this.genLabel()):t.push(this.genLabel()),e("div",{attrs:{role:o,tabindex:this.tabindex,"aria-checked":String(this.checked)},class:a([{disabled:this.isDisabled,"label-disabled":this.labelDisabled},this.direction]),on:{click:this.onClick}},[t])}}}},2464:function(e,t,a){},"2bdd":function(e,t,a){"use strict";var i=a("d282"),n=a("02de"),s=a("a8c1"),r=a("5fbe"),o=a("543e"),c=Object(i["a"])("list"),l=c[0],g=c[1],d=c[2];t["a"]=l({mixins:[Object(r["a"])((function(e){this.scroller||(this.scroller=Object(s["d"])(this.$el)),e(this.scroller,"scroll",this.check)}))],model:{prop:"loading"},props:{error:Boolean,loading:Boolean,finished:Boolean,errorText:String,loadingText:String,finishedText:String,immediateCheck:{type:Boolean,default:!0},offset:{type:[Number,String],default:300},direction:{type:String,default:"down"}},data:function(){return{innerLoading:this.loading}},updated:function(){this.innerLoading=this.loading},mounted:function(){this.immediateCheck&&this.check()},watch:{loading:"check",finished:"check"},methods:{check:function(){var e=this;this.$nextTick((function(){if(!(e.innerLoading||e.finished||e.error)){var t,a=e.$el,i=e.scroller,s=e.offset,r=e.direction;t=i.getBoundingClientRect?i.getBoundingClientRect():{top:0,bottom:i.innerHeight};var o=t.bottom-t.top;if(!o||Object(n["a"])(a))return!1;var c=!1,l=e.$refs.placeholder.getBoundingClientRect();c="up"===r?t.top-l.top<=s:l.bottom-t.bottom<=s,c&&(e.innerLoading=!0,e.$emit("input",!0),e.$emit("load"))}}))},clickErrorText:function(){this.$emit("update:error",!1),this.check()},genLoading:function(){var e=this.$createElement;if(this.innerLoading&&!this.finished)return e("div",{class:g("loading"),key:"loading"},[this.slots("loading")||e(o["a"],{attrs:{size:"16"}},[this.loadingText||d("loading")])])},genFinishedText:function(){var e=this.$createElement;if(this.finished){var t=this.slots("finished")||this.finishedText;if(t)return e("div",{class:g("finished-text")},[t])}},genErrorText:function(){var e=this.$createElement;if(this.error){var t=this.slots("error")||this.errorText;if(t)return e("div",{on:{click:this.clickErrorText},class:g("error-text")},[t])}}},render:function(){var e=arguments[0],t=e("div",{ref:"placeholder",class:g("placeholder")});return e("div",{class:g(),attrs:{role:"feed","aria-busy":this.innerLoading}},["down"===this.direction?this.slots():t,this.genLoading(),this.genFinishedText(),this.genErrorText(),"up"===this.direction?this.slots():t])}})},"37ff":function(e,t,a){},"3acc":function(e,t,a){"use strict";var i=a("d282"),n=a("78eb"),s=a("9884"),r=Object(i["a"])("checkbox-group"),o=r[0],c=r[1];t["a"]=o({mixins:[Object(s["b"])("vanCheckbox"),n["a"]],props:{max:[Number,String],disabled:Boolean,direction:String,iconSize:[Number,String],checkedColor:String,value:{type:Array,default:function(){return[]}}},watch:{value:function(e){this.$emit("change",e)}},methods:{toggleAll:function(e){if(!1!==e){var t=this.children;e||(t=t.filter((function(e){return!e.checked})));var a=t.map((function(e){return e.name}));this.$emit("input",a)}else this.$emit("input",[])}},render:function(){var e=arguments[0];return e("div",{class:c([this.direction])},[this.slots()])}})},"417e":function(e,t,a){"use strict";var i=a("d282"),n=a("0a26"),s=Object(i["a"])("checkbox"),r=s[0],o=s[1];t["a"]=r({mixins:[Object(n["a"])({bem:o,role:"checkbox",parent:"vanCheckbox"})],computed:{checked:{get:function(){return this.parent?-1!==this.parent.value.indexOf(this.name):this.value},set:function(e){this.parent?this.setParentValue(e):this.$emit("input",e)}}},watch:{value:function(e){this.$emit("change",e)}},methods:{toggle:function(e){var t=this;void 0===e&&(e=!this.checked),clearTimeout(this.toggleTask),this.toggleTask=setTimeout((function(){t.checked=e}))},setParentValue:function(e){var t=this.parent,a=t.value.slice();if(e){if(t.max&&a.length>=t.max)return;-1===a.indexOf(this.name)&&(a.push(this.name),t.$emit("input",a))}else{var i=a.indexOf(this.name);-1!==i&&(a.splice(i,1),t.$emit("input",a))}}}})},6370:function(e,t,a){"use strict";a("3cd0"),a("64d7")},"64d7":function(e,t,a){},7472:function(e,t,a){},"93b0":function(e,t,a){"use strict";a("3cd0"),a("25bb"),a("37ff")},9753:function(e,t,a){"use strict";a("3cd0"),a("1a44"),a("acc2"),a("2464")},be8b:function(e,t,a){"use strict";var i=a("7472"),n=a.n(i);n.a},edad:function(e,t,a){"use strict";a.r(t);var i,n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("div",{staticClass:"omsp-eventregist",attrs:{id:"omspeventregist"}},[a("van-nav-bar",{staticClass:"omsp-nav-bar",attrs:{title:"发布登记","left-text":"返回","left-arrow":"",fixed:""},on:{"click-left":e.backToIndex}}),a("div",{staticClass:"omsp-eventregist-body"},[a("van-tabs",{attrs:{"lazy-render":!1},model:{value:e.tabNum,callback:function(t){e.tabNum=t},expression:"tabNum"}},[a("van-tab",{attrs:{title:"基本信息"}},[a("van-cell-group",[a("van-field",{attrs:{"input-align":"right",required:"",clearable:"",label:"发布标题",placeholder:"请输入",clickable:""},model:{value:e.title,callback:function(t){e.title=t},expression:"title"}}),a("van-field",{attrs:{"input-align":"right",required:"",clearable:"",label:"发布人",placeholder:"请输入",clickable:"",readonly:""},model:{value:e.username,callback:function(t){e.username=t},expression:"username"}}),a("van-field",{attrs:{"input-align":"right",required:"",clearable:"",label:"发布时间",placeholder:"点击选择时间",clickable:"",readonly:""},on:{click:function(t){e.showReleaseDatePickerFlag=!0}},model:{value:e.release_date,callback:function(t){e.release_date=t},expression:"release_date"}}),a("van-field",{attrs:{"input-align":"right",required:"",clearable:"",label:"所属部门",placeholder:"点击选择所属部门","default-index":"0",clickable:"","right-icon":"arrow",readonly:""},on:{click:function(t){e.showOriginSelectorFlag=!0}},model:{value:e.origin.name,callback:function(t){e.$set(e.origin,"name",t)},expression:"origin.name"}}),a("van-field",{attrs:{"input-align":"right",required:"",clearable:"",label:"所属团队",placeholder:"点击选择所属团队",clickable:"","right-icon":"arrow",readonly:""},on:{click:function(t){e.showTeamSelectorFlag=!0}},model:{value:e.team.name,callback:function(t){e.$set(e.team,"name",t)},expression:"team.name"}}),a("van-field",{attrs:{"input-align":"right",required:"",clearable:"",label:"所属系统",placeholder:"点击选择所属系统",clickable:"","right-icon":"arrow",readonly:""},on:{click:function(t){e.showTargetSysSelectorFlag=!0}},model:{value:e.targetSys.name,callback:function(t){e.$set(e.targetSys,"name",t)},expression:"targetSys.name"}}),a("van-field",{attrs:{"input-align":"right",required:"",clearable:"",label:"优先级",placeholder:"点击选择优先级",clickable:"","right-icon":"arrow",readonly:""},on:{click:function(t){e.showUrgencySelectorFlag=!0}},model:{value:e.urgency.name,callback:function(t){e.$set(e.urgency,"name",t)},expression:"urgency.name"}}),a("van-field",{attrs:{"input-align":"right",clearable:"",label:"发布包名称",placeholder:"请输入",clickable:""},model:{value:e.package_name,callback:function(t){e.package_name=t},expression:"package_name"}}),a("van-field",{attrs:{"input-align":"right",clearable:"",label:"发布包版本",placeholder:"请输入",clickable:""},model:{value:e.package_version,callback:function(t){e.package_version=t},expression:"package_version"}})],1),a("van-cell-group",[a("van-panel",{attrs:{title:"目标SERVER",icon:"comment"}},[a("p",{staticStyle:{color:"green","margin-left":"9%","font-size":"12px"}},[e._v("\n                注：目标server录入格式ip:端口，多个server用;分隔。如：192.168.10.1:8081;192.168.10.1:8082")]),a("van-field",{attrs:{"label-width":"0px",type:"textarea",placeholder:"请输入目标SERVER",rows:"2",autosize:e.targetServerTextarea,clearable:""},model:{value:e.target_server,callback:function(t){e.target_server=t},expression:"target_server"}}),a("div",{attrs:{id:"toolbar-container"}})],1)],1),a("van-cell-group",[a("van-panel",{attrs:{title:"发布描述",icon:"comment"}},[a("van-field",{attrs:{"label-width":"0px",type:"textarea",placeholder:"请输入发布描述",rows:"2",autosize:e.targetServerTextarea,clearable:""},model:{value:e.description,callback:function(t){e.description=t},expression:"description"}}),a("div",{attrs:{id:"toolbar-container2"}})],1)],1),a("van-cell-group",[a("van-panel",{attrs:{title:"发布内容",icon:"notes-o"}},[a("van-checkbox-group",{model:{value:e.checkBoxResult,callback:function(t){e.checkBoxResult=t},expression:"checkBoxResult"}},[a("van-list",{attrs:{finished:e.loadFinish,"finished-text":"没有更多了"},model:{value:e.loading,callback:function(t){e.loading=t},expression:"loading"}},e._l(e.list,(function(t){return a("van-panel",{key:t.change_id,staticClass:"omsp-panel",on:{click:function(a){return e.toggle(t.change_id)}}},[a("div",{attrs:{slot:"header"},slot:"header"}),a("div",{attrs:{slot:"default"},slot:"default"},[a("van-row",{staticStyle:{height:"85px"}},[a("van-col",{attrs:{span:"6"}},[a("van-checkbox",{key:t.change_id,ref:"checkboxes",refInFor:!0,staticStyle:{margin:"30%"},attrs:{name:t.change_id}})],1),a("van-col",{attrs:{span:"12"}},[a("p",{staticClass:"ellipsis2",staticStyle:{"font-size":"12px",color:"#969799"}},[e._v(e._s(t.change_id))]),a("p",{staticClass:"ellipsis2",staticStyle:{"font-size":"20px"}},[e._v(e._s(t.title))]),"01"===t.change_type?a("van-tag",{attrs:{type:"primary"}},[e._v("标准变更")]):e._e(),"02"===t.change_type?a("van-tag",{attrs:{type:"warning"}},[e._v("紧急变更")]):e._e(),"03"===t.change_type?a("van-tag",{attrs:{type:"danger"}},[e._v("重大变更")]):e._e(),"03"===t.source?a("van-tag",{attrs:{mark:"",type:"success"}},[e._v("来源:变更创建")]):e._e(),"02"===t.source?a("van-tag",{attrs:{mark:"",type:"success"}},[e._v("来源:问题管理")]):e._e(),"01"===t.source?a("van-tag",{attrs:{mark:"",type:"success"}},[e._v("来源:事件管理")]):e._e()],1),a("van-col",{attrs:{span:"6"}},[a("p",{staticClass:"ellipsis2",staticStyle:{"font-size":"12px",color:"#969799","margin-top":"20px"}},[e._v("申请人：")]),a("p",{staticClass:"ellipsis2",staticStyle:{"font-size":"12px",color:"#969799"}},[e._v(e._s(t.applicant))])])],1)],1)])})),1)],1)],1)],1)],1),a("van-tab",{attrs:{title:"附件管理"}},[a("task-file",{attrs:{bsid:e.bsid||e.$route.params.bsid,biz_code:e.biz_code}})],1)],1)],1),a("div",{staticClass:"omsp-eventregist-foot"},[a("div",{staticClass:"omsp-eventregist-foot-grid"},[a("div",{staticClass:"omsp-eventregist-foot-grid-item",staticStyle:{"background-color":"#1A88E9"}},[a("div",{staticClass:"omsp-eventregist-foot-grid-item-center",on:{click:function(t){return e.save("commit")}}},[a("span",{staticClass:"omsp-eventregist-foot-grid-item-center-text"},[e._v("提交")])])]),a("div",{staticClass:"omsp-eventregist-foot-grid-item",staticStyle:{"background-color":"#BBBCC2"}},[a("div",{staticClass:"omsp-eventregist-foot-grid-item-center",on:{click:function(t){return e.save("draft")}}},[a("span",{staticClass:"omsp-eventregist-foot-grid-item-center-text"},[e._v("存为草稿")])])])])]),a("van-popup",{attrs:{position:"bottom"},model:{value:e.showReleaseDatePickerFlag,callback:function(t){e.showReleaseDatePickerFlag=t},expression:"showReleaseDatePickerFlag"}},[a("van-datetime-picker",{attrs:{type:"datetime",title:"发布时间","min-date":e.minReleaseDate,"max-date":e.maxReleaseDate},on:{confirm:e.confirmReleaseDate,cancel:function(t){e.showReleaseDatePickerFlag=!1}},model:{value:e.pickingReleaseDate,callback:function(t){e.pickingReleaseDate=t},expression:"pickingReleaseDate"}})],1),a("van-popup",{attrs:{position:"bottom"},model:{value:e.showUrgencySelectorFlag,callback:function(t){e.showUrgencySelectorFlag=t},expression:"showUrgencySelectorFlag"}},[a("van-picker",{attrs:{loading:e.urgencyLoading,columns:e.urgencySelector,"show-toolbar":"",title:"优先级"},on:{cancel:function(t){e.showUrgencySelectorFlag=!1},confirm:e.confirmUrgency}})],1),a("van-popup",{attrs:{position:"bottom"},model:{value:e.showOriginSelectorFlag,callback:function(t){e.showOriginSelectorFlag=t},expression:"showOriginSelectorFlag"}},[a("van-picker",{attrs:{loading:e.originLoading,columns:e.originSelector,"show-toolbar":"",title:"所属部门"},on:{cancel:function(t){e.showOriginSelectorFlag=!1},confirm:e.confirmOrigin}})],1),a("van-popup",{attrs:{position:"bottom"},model:{value:e.showTeamSelectorFlag,callback:function(t){e.showTeamSelectorFlag=t},expression:"showTeamSelectorFlag"}},[a("van-picker",{attrs:{loading:e.teamLoading,columns:e.teamSelector,"show-toolbar":"",title:"所属团队"},on:{cancel:function(t){e.showTeamSelectorFlag=!1},confirm:e.confirmTeam}})],1),a("van-popup",{attrs:{position:"bottom"},model:{value:e.showTargetSysSelectorFlag,callback:function(t){e.showTargetSysSelectorFlag=t},expression:"showTargetSysSelectorFlag"}},[a("van-picker",{attrs:{loading:e.targetSysLoading,columns:e.targetSysSelector,"show-toolbar":"",title:"所属系统"},on:{cancel:function(t){e.showTargetSysSelectorFlag=!1},confirm:e.confirmTargetSys}})],1)],1)])},s=[],r=(a("47e2"),a("2241")),o=(a("6762"),a("bd86")),c=(a("558f"),a("0b33")),l=(a("8990"),a("5e46")),g=(a("d707"),a("8f80")),d=(a("a035"),a("21ab")),u=(a("4072"),a("2830")),h=(a("2a53"),a("34e9")),m=(a("6370"),a("3acc")),f=(a("9753"),a("417e")),p=(a("3ec1"),a("7744")),b=(a("8e11"),a("f253")),v=(a("81a6"),a("7bd9")),k=(a("c625"),a("b650")),y=(a("87d0"),a("e41f")),S=(a("47d1"),a("9ffb")),_=(a("4bc8"),a("d1e1")),x=(a("4071"),a("a3e2")),O=(a("578d"),a("ee83")),w=(a("93b0"),a("2bdd")),L=(a("aa1f"),a("ea47")),R=(a("9eda"),a("565f")),D=(a("433b"),a("d399")),T=(a("da02"),a("6b41")),F=a("0ed4"),j={name:"OmspAddProblem",components:(i={},Object(o["a"])(i,T["a"].name,T["a"]),Object(o["a"])(i,D["a"].name,D["a"]),Object(o["a"])(i,R["a"].name,R["a"]),Object(o["a"])(i,L["a"].name,L["a"]),Object(o["a"])(i,w["a"].name,w["a"]),Object(o["a"])(i,O["a"].name,O["a"]),Object(o["a"])(i,x["a"].name,x["a"]),Object(o["a"])(i,_["a"].name,_["a"]),Object(o["a"])(i,S["a"].name,S["a"]),Object(o["a"])(i,y["a"].name,y["a"]),Object(o["a"])(i,k["a"].name,k["a"]),Object(o["a"])(i,v["a"].name,v["a"]),Object(o["a"])(i,b["a"].name,b["a"]),Object(o["a"])(i,p["a"].name,p["a"]),Object(o["a"])(i,f["a"].name,f["a"]),Object(o["a"])(i,m["a"].name,m["a"]),Object(o["a"])(i,h["a"].name,h["a"]),Object(o["a"])(i,u["a"].name,u["a"]),Object(o["a"])(i,d["a"].name,d["a"]),Object(o["a"])(i,g["a"].name,g["a"]),Object(o["a"])(i,l["a"].name,l["a"]),Object(o["a"])(i,c["a"].name,c["a"]),Object(o["a"])(i,"TaskFile",F["a"]),i),data:function(){return{releaseData:{},biz_code:"FB",tabNum:0,list:[],checkBoxResult:[],refreshing:!1,loading:!1,loadFinish:!0,bsid:"",incident_id:"",problem_id:"",title:"",userid:"",username:"",showReleaseDatePickerFlag:!1,minReleaseDate:new Date(2e3,0,1),maxReleaseDate:new Date,pickingReleaseDate:new Date,release_date:"",urgency:{},showUrgencySelectorFlag:!1,urgencyLoading:!0,urgencySelector:[],urgencyList:[],origin:"",showOriginSelectorFlag:!1,originLoading:!0,originSelector:[],originList:[],team:{},showTeamSelectorFlag:!1,teamLoading:!0,teamSelector:[],teamList:[],showTargetSysSelectorFlag:!1,targetSysSelector:[],targetSys:{},targetSysLoading:!0,targetSysList:[],package_name:"",package_version:"",target_server:"",targetServerTextarea:{maxHeight:150,minHeight:50},description:"",imgPreviewList:[],imgFileList:[]}},computed:{maxPlanFinishDate:function(){var e=new Date;return e.setMonth(e.getMonth()+6),e}},mounted:function(){this.getBasicInfo()},methods:{backToIndex:function(){this.$router.slid="right",this.$router.back()},refresh:function(){var e=this;this.list=[],this.loading=!1,this.loadFinish=!0,this.$OmspRequest.sendRequest({url:"/appReleaseRestService/queryReleaseContent",data:{target_sys:this.targetSys.id}}).then((function(t){e.list=JSON.parse(t.data.result),e.refreshing=!1,e.loading=!1,e.loadFinish=!0})).catch((function(e){JSON.stringify(e),Object(D["a"])("加载待办列表失败，请重新登录")})).finally((function(){e.refreshing=!1,e.loading=!1,e.loadFinish=!0}))},toggle:function(e){for(var t=0;t<this.list.length;t++)e===this.list[t].change_id&&this.$refs.checkboxes[t].toggle()},confirmReleaseDate:function(e){var t=e.getMonth()+1;this.release_date=e.getFullYear()+"-"+(t>9?t:"0"+t)+"-"+(e.getDate()>9?e.getDate():"0"+e.getDate())+" "+(e.getHours()>9?e.getHours():"0"+e.getHours())+":"+(e.getMinutes()>9?e.getMinutes():"0"+e.getMinutes())+":00",this.showReleaseDatePickerFlag=!1},confirmUrgency:function(e,t){this.urgency=this.urgencyList[t],this.showUrgencySelectorFlag=!1},confirmOrigin:function(e,t){this.origin=this.originList[t],this.showOriginSelectorFlag=!1},confirmTeam:function(e,t){var a=this;this.team=this.teamList[t],this.showTeamSelectorFlag=!1,this.$OmspRequest.sendRequest({url:"/appTaskRestService/getTargetSys",data:{team_id:this.team.id}}).then((function(e){a.targetSysList=e.data.targetSysList,a.targetSysSelector=[];for(var t=0;t<a.targetSysList.length;t++)a.targetSysSelector.push(a.targetSysList[t].name);1===a.targetSysList.length&&(a.targetSys=a.targetSysList[0]),a.targetSysLoading=!1,setTimeout((function(){if(a.targetSysList)for(var e=0;e<a.targetSysList.length;e++)a.releaseData.target_sys===a.targetSysList[e].id&&(a.targetSys=a.targetSysList[e])}),0)})).catch((function(e){JSON.stringify(e),Object(D["a"])("加载失败，请重新登录")})).finally((function(){}))},confirmTargetSys:function(e,t){"number"===typeof t&&(this.targetSys=this.targetSysList[t]),this.showTargetSysSelectorFlag=!1,this.refresh()},beforeReadImg:function(e){var t=e.type,a=["image/png","image/jpeg"];return!!a.includes(t)||(D["a"].fail("请上传:png、jpeg的图片格式"),!1)},afterReadImg:function(e){return e},save:function(e){var t=this,a=this.checkForm();a.flag?r["a"].confirm({title:"通知",message:"确定这项操作吗?"}).then((function(){D["a"].loading({mask:!0,forbidClick:!0,duration:0,message:"请稍后..."});var a=t.getFormData();setTimeout((function(){t.$OmspRequest.sendRequest({url:"/appReleaseRestService/saveRelease",data:a}).then((function(a){D["a"].clear(),t.bsid=a.data.id,t.$nextTick((function(){t.$store.commit("page/removeCachePageName","OmspIndex"),"draft"===e?t.keepEdit():"commit"===e&&t.submit()}))})).catch((function(e){JSON.stringify(e),console.log(e),D["a"].fail("暂存失败")})).finally((function(){}))}),0)})).catch((function(){})):D["a"].fail(a.msg)},keepEdit:function(){var e=this;r["a"].confirm({title:"暂存成功",message:"是否继续修改？"}).then((function(){})).catch((function(){setTimeout((function(){e.$router.push({path:"index"})}))}))},submit:function(){var e=this;D["a"].loading({mask:!0,forbidClick:!0,duration:0,message:"提交中，请稍后..."});var t=this.getFormData();this.checkBoxResult.length&&0!==this.checkBoxResult.length?setTimeout((function(){e.$OmspRequest.sendRequest({url:"/appReleaseRestService/submitRelease",data:{id:t.id}}).then((function(t){D["a"].clear(),JSON.stringify(t),r["a"].alert({message:"提交成功，即将返回主页"}).then((function(){e.$store.commit("page/removeCachePageName","OmspIndex"),setTimeout((function(){e.$router.push({path:"index"})}))}))})).catch((function(e){JSON.stringify(e),D["a"].fail("提交失败")})).finally((function(){}))}),0):D["a"].fail("请选择发布内容！")},getFormData:function(){var e=[];if(this.checkBoxResult.length)for(var t=0;t<this.checkBoxResult.length;t++)for(var a=0;a<this.list.length;a++)this.checkBoxResult[t]===this.list[a].change_id&&(e[t]={},e[t]=this.list[a]);var i={urgency_desc:this.urgency.name,is_view:"",description:this.description,pos_orgname:this.origin.orgname,team_id:this.team.id,title:this.title,orgid:this.origin.id,team_id_desc:this.team.name,is_base:"1",package_version:this.package_version,release_date:this.release_date,urgency:this.urgency.id,org_id:this.origin.id,is_draft:"1",release_user:this.username,package_name:this.package_name,target_sys:this.targetSys.id,menuid:"",release_obj_list:JSON.stringify(e),id:this.bsid,target_server:this.target_server,target_sys_desc:this.targetSys.name};return i},getBasicInfo:function(){var e=this;Object(D["a"])({type:"loading",overlay:!0,message:"加载中...",duration:0,forbidClick:!0}),setTimeout((function(){e.$OmspRequest.sendRequest({url:"/appReleaseRestService/getReleaseBasicInfo",data:{}}).then((function(t){D["a"].clear(),e.username=t.data.username,e.userid=t.data.userid,e.urgencyList=t.data.urgencyList,e.urgencySelector=[];for(var a=0;a<e.urgencyList.length;a++)e.urgencySelector.push(e.urgencyList[a].name);e.urgencyLoading=!1,e.originList=t.data.originList,e.originSelector=[];for(var i=0;i<e.originList.length;i++)e.originSelector.push(e.originList[i].orgname);e.originLoading=!1,1===e.originList.length&&(e.origin=e.originList[0]),e.teamList=t.data.teamList,e.teamSelector=[];for(var n=0;n<e.teamList.length;n++)e.teamSelector.push(e.teamList[n].name);e.teamLoading=!1,1===e.teamList.length&&(e.team=e.teamList[0],e.confirmTeam("",0)),e.$route.query.bsid&&e.getInfoData(e.$route.query.bsid)})).catch((function(e){JSON.stringify(e),Object(D["a"])("加载失败，请重新登录")})).finally((function(){}))}),0)},checkForm:function(){var e={flag:!1,msg:""};return""===this.title?e.msg="请输入标题":""===this.username?e.msg="没有申请人":""===this.release_date?e.msg="请输入发布时间":""===this.urgency?e.msg="请选择优先级":""===this.origin?e.msg="所属部门为空":""===this.team?e.msg="请选择所属团队":""===this.targetSys?e.msg="请选择所属系统":""===this.target_server?e.msg="目标SERVER":""===this.description?e.msg="请输入发布描述":e.flag=!0,e},getInfoData:function(e){var t=this;setTimeout((function(){t.$OmspRequest.sendRequest({url:"/appReleaseRestService/getRelease",data:{id:e}}).then((function(e){t.releaseData=JSON.parse(e.data.result),t.bsid=t.releaseData.id,t.title=t.releaseData.title,t.release_date=t.releaseData.release_date;for(var a=0;a<t.urgencyList.length;a++)t.releaseData.urgency===t.urgencyList[a].id&&(t.urgency=t.urgencyList[a]);for(var i=0;i<t.originList.length;i++)t.releaseData.orgid===t.originList[i].id&&(t.origin=t.originList[i]);for(var n=0;n<t.teamList.length;n++)t.releaseData.team_id===t.teamList[n].id&&t.confirmTeam("",n);t.package_name=t.releaseData.package_name,t.package_version=t.releaseData.package_version,t.target_server=t.releaseData.target_server,t.description=t.releaseData.description;for(var s=0;s<t.releaseData.release_obj_list.length;s++)t.releaseData.release_obj_list[s].change_id&&(t.list.push(t.releaseData.release_obj_list[s]),t.checkBoxResult[s]=t.releaseData.release_obj_list[s].change_id);for(var r=0;r<t.releaseData.no_release_obj_list.length;r++)t.releaseData.no_release_obj_list[r].change_id&&t.list.push(t.releaseData.no_release_obj_list[r])})).catch((function(e){JSON.stringify(e),Object(D["a"])("加载失败，请重新登录")})).finally((function(){}))}),0)}}},$=j,C=(a("be8b"),a("2877")),B=Object(C["a"])($,n,s,!1,null,null,null);t["default"]=B.exports}}]);